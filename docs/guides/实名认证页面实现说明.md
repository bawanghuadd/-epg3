# 实名认证页面实现说明

## 📱 页面概览

实名认证页面用于用户提交身份信息进行实名认证，包括姓名、身份证号和身份证照片上传。

## 🎨 页面结构

### 1. 顶部导航栏
- 返回按钮（左侧"←"）
- 标题"实名认证"（居中）
- 自定义导航栏

### 2. 认证说明卡片
- **背景**：红色渐变 (#F44336 → #E53935)
- **内容**：
  - 盾牌图标 🛡️（圆形半透明背景）
  - 标题"实名认证"
  - 副标题"保障您的账户安全，享受更多服务"
- **样式**：带阴影效果

### 3. 为什么需要实名认证
- **背景**：橙色渐变 (#FFF9E6 → #FFE7BA)
- **边框**：橙色边框
- **内容**：
  - 💡 图标 + "为什么需要实名认证？"标题
  - 4条说明：
    - 保障您的账户安全
    - 享受更多平台服务
    - 符合国家实名制要求
    - 提升订单成交率

### 4. 表单区域

#### 4.1 真实姓名
- 图标：👤
- 输入框：文本输入
- 提示文字："请输入您的真实姓名"

#### 4.2 身份证号码
- 图标：🪪
- 输入框：文本输入，限制18位
- 提示文字："请输入身份证号码"
- 验证：支持15位或18位身份证号（包括最后一位X）

#### 4.3 上传身份证照片
- 图标：📤
- **两个上传框**：
  - 身份证人像面（左侧）
  - 身份证国徽面（右侧）
- 上传框样式：
  - 虚线边框
  - 图标 + 文字 + "点击上传"提示
  - 上传后显示图片预览
- 查看示例链接：📷 查看示例图片

#### 4.4 同意协议
- 复选框（红色主题色）
- 协议文本：
  - "我已阅读并同意《实名认证协议》和《隐私政策》，承诺提供的信息真实有效"
  - 协议名称为红色可点击链接

#### 4.5 提交按钮
- 文字："✓ 提交认证"
- 样式：
  - 红色渐变背景
  - 圆角按钮
  - 带阴影效果
- 状态：
  - 未填写完整：灰色禁用状态
  - 填写完整且同意协议：可点击

### 5. 温馨提示
- **背景**：浅蓝色 (#F0F7FF)
- **边框**：蓝色边框
- **内容**：
  - 💡 图标 + "温馨提示"标题
  - 4条提示：
    - 请确保照片清晰完整，四角完整可见
    - 照片大小不超过5MB，支持JPG、PNG格式
    - 您的信息将被加密保护，仅用于实名认证
    - 认证审核通常在1-3个工作日内完成

## 📊 数据结构

### 表单数据
```typescript
{
  realName: string,        // 真实姓名
  idCard: string,          // 身份证号码
  idCardFront: string,     // 身份证正面照片路径
  idCardBack: string      // 身份证反面照片路径
}
```

### 用户认证状态
```typescript
{
  is_verified: boolean,           // 是否已认证
  verify_status: string,          // 认证状态：pending/approved/rejected
  verify_time: string,            // 认证时间
  real_name: string,              // 实名
  id_card_masked: string         // 脱敏后的身份证号
}
```

## 🔄 核心功能

### 1. 返回上一页
```typescript
function goBack() {
  uni.navigateBack()
}
```

### 2. 选择图片
```typescript
function chooseImage(type: 'front' | 'back') {
  // 使用 uni.chooseImage 选择图片
  // 支持从相册选择或拍照
  // 自动压缩图片
  // 保存到formData
}
```

### 3. 查看示例图片
```typescript
function showExample() {
  // 显示身份证拍照示例说明
  // 提示照片要求
}
```

### 4. 同意协议
```typescript
function onAgreementChange(e) {
  // 复选框状态改变
  // 更新agreed状态
}
```

### 5. 查看协议
```typescript
function viewAgreement(type: 'verify' | 'privacy') {
  // 点击协议链接
  // 跳转到协议详情页面
}
```

### 6. 身份证号验证
```typescript
function validateIdCard(idCard: string): boolean {
  // 验证身份证号格式
  // 支持15位或18位
  // 最后一位支持X
  const reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/
  return reg.test(idCard)
}
```

### 7. 提交认证
```typescript
function handleSubmit() {
  // 1. 检查表单完整性
  // 2. 验证身份证号格式
  // 3. 显示确认对话框
  // 4. 提交认证信息
}
```

### 8. 提交实名认证
```typescript
function submitVerification() {
  // 1. 显示加载提示
  // 2. 上传身份证照片到服务器
  // 3. 调用后端API提交认证信息
  // 4. 更新本地用户信息
  // 5. 返回上一页
}
```

## 🎯 交互逻辑

### 表单填写流程
1. 输入真实姓名
2. 输入身份证号码（自动验证格式）
3. 上传身份证正面照片
4. 上传身份证反面照片
5. 勾选同意协议
6. 点击"提交认证"

### 提交按钮状态
- **禁用状态**（灰色）：
  - 姓名未填写
  - 身份证号未填写
  - 身份证照片未上传（任一）
  - 未勾选协议
  
- **可用状态**（红色渐变）：
  - 所有信息已填写完整
  - 已勾选协议

### 图片上传交互
1. 点击上传框
2. 选择图片来源（相册/拍照）
3. 选择图片
4. 自动压缩
5. 显示图片预览
6. 可重新上传替换

### 提交确认流程
1. 点击"提交认证"
2. 验证身份证号格式
3. 显示确认对话框："请确认您提供的信息真实有效"
4. 确认后开始提交
5. 显示加载提示"提交中..."
6. 提交成功后显示："您的实名认证申请已提交，我们将在1-3个工作日内完成审核"
7. 更新本地认证状态为"审核中"
8. 自动返回上一页

## 🎨 UI 特点

### 1. 红色主题
- 顶部认证说明卡片：红色渐变
- 提交按钮：红色渐变
- 复选框：红色
- 协议链接：红色

### 2. 信息层级清晰
- 说明卡片突出显示
- 原因说明用橙色卡片区分
- 表单区域清晰
- 温馨提示用蓝色卡片

### 3. 图标使用
- Emoji图标增强视觉效果
- 每个表单项都有图标标识
- 图标大小和颜色统一

### 4. 响应式反馈
- 按钮禁用/可用状态
- 图片上传前后状态
- 复选框勾选状态
- 加载提示

## 🔌 后端接口（待对接）

### 1. 上传身份证照片
```
POST /api/upload/idcard
Request: FormData (file)
Response: {
  url: string  // 图片URL
}
```

### 2. 提交实名认证
```
POST /api/user/verify
Request: {
  real_name: string,           // 真实姓名
  id_card: string,             // 身份证号
  id_card_front_url: string,   // 身份证正面照片URL
  id_card_back_url: string     // 身份证反面照片URL
}
Response: {
  verify_id: string,           // 认证申请ID
  status: 'pending',           // 审核状态
  message: string             // 提示信息
}
```

### 3. 查询认证状态
```
GET /api/user/verify/status
Response: {
  is_verified: boolean,
  verify_status: 'pending' | 'approved' | 'rejected',
  verify_time: string,
  reject_reason: string       // 拒绝原因（如果被拒绝）
}
```

## 📱 路由配置

### 页面路径
```
/pages/profile/verify
```

### 页面配置（pages.json）
```json
{
  "path": "pages/profile/verify",
  "style": {
    "navigationBarTitleText": "实名认证",
    "navigationStyle": "custom",
    "enablePullDownRefresh": false
  }
}
```

### 跳转方式
```typescript
// 从个人中心跳转
uni.navigateTo({
  url: '/pages/profile/verify'
})
```

## ✅ 已完成功能

✓ 顶部导航栏（自定义，带返回按钮）  
✓ 认证说明卡片（红色渐变）  
✓ 为什么需要实名认证说明（橙色卡片）  
✓ 真实姓名输入框  
✓ 身份证号码输入框（限制18位）  
✓ 身份证照片上传（正面+反面）  
✓ 图片选择功能（相册/拍照）  
✓ 图片预览功能  
✓ 查看示例图片  
✓ 同意协议复选框  
✓ 查看协议功能（点击链接）  
✓ 提交按钮（动态启用/禁用）  
✓ 身份证号格式验证  
✓ 提交确认对话框  
✓ 提交成功提示  
✓ 本地认证状态更新  
✓ 温馨提示区域  
✓ 响应式布局

## 🎯 使用说明

### 从个人中心进入
1. 点击个人中心的"实名认证"菜单
2. 如果已认证，显示"您已完成实名认证"
3. 如果未认证，跳转到实名认证页面

### 填写认证信息
1. 输入真实姓名（必须与身份证一致）
2. 输入身份证号码（自动验证格式）
3. 上传身份证正面照片
4. 上传身份证反面照片
5. 查看示例图片了解拍照要求
6. 勾选同意协议
7. 点击"提交认证"

### 照片要求
- 照片清晰完整，四角可见
- 光线充足，无反光遮挡
- 文字清晰可辨认
- 照片大小不超过5MB
- 支持JPG、PNG格式

### 审核流程
1. 提交后进入"审核中"状态
2. 审核通常在1-3个工作日内完成
3. 审核通过后，用户状态更新为"已认证"
4. 审核拒绝会显示拒绝原因，可重新提交

## 💡 注意事项

### 1. 数据安全
- 身份证信息加密存储
- 身份证照片加密传输
- 仅用于实名认证
- 符合国家信息安全要求

### 2. 验证规则
- 姓名：2-10个汉字
- 身份证号：15位或18位，最后一位支持X
- 照片：JPG/PNG格式，小于5MB

### 3. 用户体验
- 实时表单验证
- 清晰的错误提示
- 提交前二次确认
- 审核进度可查询

### 4. 异常处理
- 图片上传失败重试
- 网络异常提示
- 认证失败原因说明
- 支持重新提交

---

**注意**：
1. 当前图片上传使用本地路径，实际需对接后端上传接口
2. 提交认证为模拟提交，实际需调用后端API
3. 审核状态需从后端实时查询
4. 协议页面需单独创建

