# 消息页面实现说明

## 📱 页面概览

消息页面实现了完整的消息通知功能，包括4种消息分类和最近消息列表。

## 🎨 页面结构

### 1. 顶部导航栏
- **标题**：消息通知
- **操作按钮**：全部已读（蓝色按钮）
- **功能**：点击"全部已读"可批量标记所有消息为已读

### 2. 消息分类（4种）

#### 2.1 客服消息 👨‍💼
- **描述**：客服回复、咨询记录
- **颜色**：蓝色渐变 (#E6F7FF → #BAE7FF)
- **功能**：点击进入客服消息列表

#### 2.2 系统消息 🔔
- **描述**：账号、安全、功能通知
- **颜色**：橙色渐变 (#FFF7E6 → #FFD591)
- **功能**：点击进入系统消息列表

#### 2.3 公告 📢
- **描述**：平台公告、活动通知
- **颜色**：红色渐变 (#FFF1F0 → #FFCCC7)
- **功能**：点击进入公告列表

#### 2.4 订单消息 📦
- **描述**：订单状态、服务进度
- **颜色**：绿色渐变 (#F6FFED → #D9F7BE)
- **功能**：点击进入订单消息列表

### 3. 最近消息
- **显示内容**：
  - 消息图标（带颜色渐变背景）
  - 消息标题
  - 消息内容（单行省略）
  - 时间
  - 未读标记（红点）
- **交互**：
  - 点击消息自动标记为已读
  - 根据消息类型跳转到对应页面
  - 未读消息内容加粗显示

### 4. 底部导航栏
- 首页 🏠
- 订单 📋
- 悬浮按钮 ➕（创建订单）
- **消息 💬（当前页，高亮显示）**
- 我的 👤

## 📊 数据结构

### 消息分类数据
```typescript
{
  id: number,              // 分类ID
  type: string,            // 分类类型：service/system/notice/order
  icon: string,            // 图标emoji
  title: string,           // 分类名称
  desc: string,            // 分类描述
  colorClass: string,      // 颜色类：blue/orange/red/green
  unread: number          // 未读数量
}
```

### 消息数据
```typescript
{
  id: number,              // 消息ID
  type: string,            // 消息类型：service/system/notice/order
  icon: string,            // 图标emoji
  iconClass: string,       // 图标颜色类
  title: string,           // 消息标题
  content: string,         // 消息内容
  time: string,            // 时间
  isRead: boolean         // 是否已读
}
```

## 🔄 核心功能

### 1. 消息加载
```typescript
function loadMessages() {
  // TODO: 调用后端API
  // GET /api/messages
}
```

### 2. 更新分类未读数
```typescript
function updateCategoryUnread() {
  // 根据消息列表自动统计各分类的未读数量
}
```

### 3. 点击消息分类
```typescript
function handleCategoryClick(category) {
  // 跳转到分类消息列表页面
  // /pages/message/list?type={type}&title={title}
}
```

### 4. 点击消息
```typescript
function handleMessageClick(msg) {
  // 1. 标记为已读
  // 2. 根据消息类型跳转：
  //    - order: 订单消息详情
  //    - service: 客服对话
  //    - system/notice: 消息详情
}
```

### 5. 全部已读
```typescript
function markAllRead() {
  // 1. 显示确认弹窗
  // 2. 批量标记所有消息为已读
  // 3. 更新分类未读数
  // TODO: POST /api/messages/read-all
}
```

## 🎯 交互逻辑

### 消息分类交互
1. 点击分类卡片 → 跳转到对应分类的消息列表页面
2. 显示未读数量徽章（超过99显示"99+"）
3. 右侧箭头指示可点击

### 消息列表交互
1. **未读消息**：
   - 右侧显示红点
   - 消息内容文字颜色深、加粗
   - 点击后自动标记为已读

2. **已读消息**：
   - 无红点
   - 消息内容文字颜色浅

3. **消息跳转**：
   - 订单消息 → 订单详情页
   - 客服消息 → 客服对话页
   - 系统/公告 → 消息详情页

### 全部已读交互
1. 点击右上角"全部已读"
2. 弹出确认对话框
3. 确认后标记所有消息为已读
4. 显示成功提示

## 🎨 UI 特点

### 1. 消息分类卡片
- 圆角卡片设计（16rpx）
- 彩色渐变图标背景
- 清晰的层次结构
- 未读徽章醒目显示

### 2. 消息列表项
- 紧凑的单行布局
- 未读消息突出显示
- 时间相对显示（10分钟前、昨天等）
- 单行省略长文本

### 3. 空状态
- 居中显示大图标
- 友好的提示文案

## 🔌 后端接口（待对接）

### 1. 获取消息列表
```
GET /api/messages
Response: {
  categories: [...],    // 消息分类统计
  messages: [...]       // 最近消息列表
}
```

### 2. 标记消息已读
```
POST /api/messages/{id}/read
```

### 3. 批量标记已读
```
POST /api/messages/read-all
```

### 4. 获取分类消息
```
GET /api/messages/list?type={type}&page={page}
Response: {
  list: [...],
  total: number
}
```

## 📱 待实现页面

### 1. 消息分类列表页
- 路径：`/pages/message/list`
- 参数：`type`, `title`
- 功能：显示某个分类的所有消息

### 2. 消息详情页
- 路径：`/pages/message/detail`
- 参数：`id`
- 功能：显示消息详细内容

### 3. 客服对话页
- 路径：`/pages/chat/service`
- 功能：与客服实时聊天

## ✅ 已完成功能

✓ 消息分类展示（客服、系统、公告、订单）  
✓ 最近消息列表  
✓ 未读消息标记  
✓ 全部已读功能  
✓ 消息点击交互  
✓ 分类未读数统计  
✓ 底部导航栏  
✓ 空状态展示  
✓ 响应式布局  
✓ 未读消息高亮显示

## 🎯 使用说明

### 查看消息
1. 从首页点击底部导航"消息"进入
2. 顶部显示4种消息分类及未读数
3. 下方显示最近消息列表
4. 点击消息自动标记已读并跳转

### 批量操作
1. 点击右上角"全部已读"
2. 确认后所有消息标记为已读
3. 未读徽章自动更新

### 分类查看
1. 点击消息分类卡片
2. 进入该分类的消息列表页面
3. 可查看所有相关消息

---

**注意**：当前使用模拟数据，实际使用需对接后端API。

