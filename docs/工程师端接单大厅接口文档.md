# å·¥ç¨‹å¸ˆç«¯æ¥å•å¤§å…æ¥å£æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†å·¥ç¨‹å¸ˆç«¯æ¥å•å¤§å…åŠŸèƒ½æ‰€éœ€çš„æ‰€æœ‰æ¥å£åŠå…¶å‚æ•°è¦æ±‚ã€‚

---

## ğŸ”Œ æ¥å£åˆ—è¡¨

### 1. è·å–å¯æ¥è®¢å•åˆ—è¡¨

**æ¥å£è¯´æ˜**ï¼šè·å–å½“å‰å·¥ç¨‹å¸ˆå¯ä»¥æ¥å–çš„è®¢å•åˆ—è¡¨ï¼Œæ”¯æŒç­›é€‰å’Œåˆ†é¡µã€‚

**æ¥å£åœ°å€**ï¼š`GET /api/engineer/orders/available`

**è¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| page | Number | å¦ | é¡µç ï¼Œä»1å¼€å§‹ | 1 |
| pageSize | Number | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10 | 10 |
| orderType | String | å¦ | è®¢å•ç±»å‹ï¼šall-å…¨éƒ¨, piecework-è®¡ä»¶å·¥èµ„, project-é¡¹ç›®åˆ¶, longterm-é•¿æœŸåˆä½œ, urgent-ç´§æ€¥è®¢å• | piecework |
| serviceType | Number | å¦ | æœåŠ¡ç±»å‹ï¼š1-æ‰¾å”®å, 2-æ‰¾å”®å‰, 3-æ‰¾å›¢é˜Ÿ, 4-å”®åå·¥ç¨‹ | 1 |
| domainId | Number | å¦ | ä¸šåŠ¡é¢†åŸŸID | 1 |
| sortBy | String | å¦ | æ’åºæ–¹å¼ï¼štime-å‘å¸ƒæ—¶é—´, price-ä»·æ ¼, distance-è·ç¦» | time |
| sortOrder | String | å¦ | æ’åºæ–¹å‘ï¼šasc-å‡åº, desc-é™åº | desc |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```javascript
GET /api/engineer/orders/available?page=1&pageSize=10&orderType=piecework&sortBy=time&sortOrder=desc
```

**è¯´æ˜**ï¼š
- **è¯·æ±‚å‚æ•°**ï¼ˆä¸Šé¢è¡¨æ ¼ï¼‰ï¼šæ˜¯ä¼ ç»™æ¥å£çš„æŸ¥è¯¢æ¡ä»¶ï¼Œç”¨äºç­›é€‰å’Œæ’åºè®¢å•
- **å“åº”æ•°æ®**ï¼ˆä¸‹é¢ç¤ºä¾‹ï¼‰ï¼šæ˜¯æ¥å£è¿”å›çš„å®Œæ•´è®¢å•ä¿¡æ¯ï¼ŒåŒ…å«è®¢å•çš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "list": [
      {
        "id": "20251107001",
        "orderNo": "#20251107001",
        "title": "ç©ºè°ƒå®‰è£…ç»´ä¿®æœåŠ¡",
        "type": "è®¡ä»¶å·¥èµ„",
        "orderType": "piecework",
        "serviceType": 1,
        "serviceTypeText": "æ‰¾å”®å",
        "domainId": 1,
        "domainName": "åœºç«™å……ç”µæ¡©",
        "address": "åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬SOHO T3åº§",
        "addressDetail": "T3åº§501å®¤",
        "latitude": 39.989617,
        "longitude": 116.480763,
        "distance": 2.5,
        "time": "2025-11-10 09:00 - 18:00",
        "serviceDate": "2025-11-10",
        "serviceStartTime": "09:00",
        "serviceEndTime": "18:00",
        "price": 800,
        "priceType": "æœåŠ¡è´¹ç”¨",
        "description": "éœ€è¦å®‰è£…ç©ºè°ƒå¹¶è¿›è¡Œè°ƒè¯•",
        "images": [
          "https://example.com/image1.jpg"
        ],
        "clientId": "user123",
        "clientName": "å¼ å…ˆç”Ÿ",
        "clientAvatar": "https://example.com/avatar.jpg",
        "clientInfo": "éœ€æ±‚æ˜ç¡®Â·å·²å‘å¸ƒ2å°æ—¶",
        "clientPhone": "138****5678",
        "isNew": true,
        "isHot": false,
        "publishTime": "2025-11-10 07:00:00",
        "deadline": "2025-11-10 12:00:00",
        "status": 2,
        "statusText": "å¾…æ¥å•"
      }
    ],
    "total": 100,
    "page": 1,
    "pageSize": 10,
    "hasMore": true
  }
}
```

**å“åº”æ•°æ®å­—æ®µè¯´æ˜**ï¼ˆdata.list ä¸­çš„è®¢å•å¯¹è±¡ï¼‰ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | String | è®¢å•ID |
| orderNo | String | è®¢å•ç¼–å·ï¼ˆå¸¦#å·ï¼‰ |
| title | String | è®¢å•æ ‡é¢˜ |
| type | String | è®¢å•ç±»å‹ä¸­æ–‡æ˜¾ç¤º |
| orderType | String | è®¢å•ç±»å‹ä»£ç ï¼ˆpiecework/projectç­‰ï¼‰ |
| serviceType | Number | æœåŠ¡ç±»å‹ï¼ˆ1/2/3/4ï¼‰ |
| serviceTypeText | String | æœåŠ¡ç±»å‹ä¸­æ–‡æ˜¾ç¤º |
| domainId | Number | ä¸šåŠ¡é¢†åŸŸID |
| domainName | String | ä¸šåŠ¡é¢†åŸŸåç§° |
| address | String | æœåŠ¡åœ°å€ |
| addressDetail | String | è¯¦ç»†åœ°å€ |
| latitude | Number | çº¬åº¦ |
| longitude | Number | ç»åº¦ |
| distance | Number | è·ç¦»ï¼ˆå…¬é‡Œï¼‰ |
| time | String | æœåŠ¡æ—¶é—´æ˜¾ç¤ºæ–‡æœ¬ |
| serviceDate | String | æœåŠ¡æ—¥æœŸ |
| serviceStartTime | String | æœåŠ¡å¼€å§‹æ—¶é—´ |
| serviceEndTime | String | æœåŠ¡ç»“æŸæ—¶é—´ |
| price | Number | ä»·æ ¼ï¼ˆå…ƒï¼‰ |
| priceType | String | ä»·æ ¼ç±»å‹ï¼ˆæœåŠ¡è´¹ç”¨/é¡¹ç›®æ€»é¢ç­‰ï¼‰ |
| description | String | è®¢å•æè¿° |
| images | Array | è®¢å•å›¾ç‰‡URLæ•°ç»„ |
| clientId | String | å®¢æˆ·ID |
| clientName | String | å®¢æˆ·å§“å |
| clientAvatar | String | å®¢æˆ·å¤´åƒURL |
| clientInfo | String | å®¢æˆ·ä¿¡æ¯æè¿° |
| clientPhone | String | å®¢æˆ·ç”µè¯ï¼ˆå·²è„±æ•ï¼‰ |
| isNew | Boolean | æ˜¯å¦æ–°è®¢å• |
| isHot | Boolean | æ˜¯å¦çƒ­é—¨è®¢å• |
| publishTime | String | å‘å¸ƒæ—¶é—´ |
| deadline | String | æ¥å•æˆªæ­¢æ—¶é—´ |
| status | Number | è®¢å•çŠ¶æ€ï¼ˆ2=å¾…æ¥å•ï¼‰ |
| statusText | String | è®¢å•çŠ¶æ€ä¸­æ–‡æ˜¾ç¤º |

**å“åº”æ•°æ®åˆ†é¡µä¿¡æ¯**ï¼ˆdata ä¸­çš„åˆ†é¡µå­—æ®µï¼‰ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| list | Array | è®¢å•åˆ—è¡¨æ•°ç»„ |
| total | Number | æ€»è®¢å•æ•° |
| page | Number | å½“å‰é¡µç  |
| pageSize | Number | æ¯é¡µæ•°é‡ |
| hasMore | Boolean | æ˜¯å¦è¿˜æœ‰æ›´å¤šæ•°æ® |

---

### 2. æ¥å•

**æ¥å£è¯´æ˜**ï¼šå·¥ç¨‹å¸ˆæ¥å–è®¢å•ã€‚

**æ¥å£åœ°å€**ï¼š`POST /api/orders/{orderId}/accept`

**è·¯å¾„å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| orderId | String | æ˜¯ | è®¢å•ID |

**è¯·æ±‚ä½“å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| remark | String | å¦ | æ¥å•å¤‡æ³¨ | "å·²äº†è§£éœ€æ±‚ï¼Œé¢„è®¡2å°æ—¶å®Œæˆ" |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```javascript
POST /api/orders/20251107001/accept
Content-Type: application/json

{
  "remark": "å·²äº†è§£éœ€æ±‚ï¼Œé¢„è®¡2å°æ—¶å®Œæˆ"
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "æ¥å•æˆåŠŸ",
  "data": {
    "orderId": "20251107001",
    "orderNo": "#20251107001",
    "status": 3,
    "statusText": "å¾…ç­¾çº¦",
    "acceptTime": "2025-11-10 08:30:00"
  }
}
```

---

### 3. æ›´æ–°åœ¨çº¿çŠ¶æ€

**æ¥å£è¯´æ˜**ï¼šå·¥ç¨‹å¸ˆåˆ‡æ¢åœ¨çº¿/ç¦»çº¿çŠ¶æ€ã€‚ç¦»çº¿çŠ¶æ€ä¸‹ä¸ä¼šæ¥æ”¶åˆ°æ–°è®¢å•æ¨é€ã€‚

**æ¥å£åœ°å€**ï¼š`PUT /api/engineer/online-status`

**è¯·æ±‚ä½“å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| isOnline | Boolean | æ˜¯ | æ˜¯å¦åœ¨çº¿ | true |
| location | Object | å¦ | ä½ç½®ä¿¡æ¯ï¼ˆåœ¨çº¿æ—¶å»ºè®®æä¾›ï¼‰ | - |
| location.latitude | Number | å¦ | çº¬åº¦ | 39.989617 |
| location.longitude | Number | å¦ | ç»åº¦ | 116.480763 |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```javascript
PUT /api/engineer/online-status
Content-Type: application/json

{
  "isOnline": true,
  "location": {
    "latitude": 39.989617,
    "longitude": 116.480763
  }
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "çŠ¶æ€æ›´æ–°æˆåŠŸ",
  "data": {
    "isOnline": true,
    "updateTime": "2025-11-10 08:00:00"
  }
}
```

---

### 4. è·å–å·¥ç¨‹å¸ˆç»Ÿè®¡æ•°æ®

**æ¥å£è¯´æ˜**ï¼šè·å–å·¥ç¨‹å¸ˆçš„ç»Ÿè®¡æ•°æ®ï¼ŒåŒ…æ‹¬æœ¬æœˆæ”¶å…¥ã€å®Œæˆè®¢å•æ•°ç­‰ã€‚

**æ¥å£åœ°å€**ï¼š`GET /api/engineer/stats`

**è¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| period | String | å¦ | ç»Ÿè®¡å‘¨æœŸï¼šmonth-æœ¬æœˆ, week-æœ¬å‘¨, today-ä»Šå¤© | month |
| month | String | å¦ | æœˆä»½ï¼ˆYYYY-MMæ ¼å¼ï¼‰ï¼Œä¸ä¼ åˆ™é»˜è®¤å½“å‰æœˆ | 2025-11 |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```javascript
GET /api/engineer/stats?period=month&month=2025-11
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "monthlyIncome": 2450.00,
    "completedOrders": 12,
    "pendingOrders": 3,
    "inProgressOrders": 2,
    "monthlyStats": {
      "totalIncome": 2450.00,
      "totalOrders": 14,
      "completedCount": 12,
      "averageIncome": 204.17,
      "averageRating": 4.8
    },
    "weekStats": {
      "totalIncome": 580.00,
      "totalOrders": 3,
      "completedCount": 3
    },
    "todayStats": {
      "totalIncome": 120.00,
      "totalOrders": 1,
      "completedCount": 1
    }
  }
}
```

---

### 5. è·å–è®¢å•è¯¦æƒ…

**æ¥å£è¯´æ˜**ï¼šè·å–è®¢å•è¯¦ç»†ä¿¡æ¯ï¼Œç”¨äºæ¥å•å‰æŸ¥çœ‹è¯¦æƒ…ã€‚

**æ¥å£åœ°å€**ï¼š`GET /api/orders/{orderId}`

**è·¯å¾„å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| orderId | String | æ˜¯ | è®¢å•ID |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```javascript
GET /api/orders/20251107001
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "id": "20251107001",
    "orderNo": "#20251107001",
    "title": "ç©ºè°ƒå®‰è£…ç»´ä¿®æœåŠ¡",
    "description": "éœ€è¦å®‰è£…ç©ºè°ƒå¹¶è¿›è¡Œè°ƒè¯•ï¼Œç°åœºéœ€è¦æä¾›ç”µæºå’Œå®‰è£…ä½ç½®",
    "serviceType": 1,
    "serviceTypeText": "æ‰¾å”®å",
    "domainId": 1,
    "domainName": "åœºç«™å……ç”µæ¡©",
    "address": "åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬SOHO T3åº§",
    "addressDetail": "T3åº§501å®¤",
    "latitude": 39.989617,
    "longitude": 116.480763,
    "distance": 2.5,
    "contact": "å¼ å…ˆç”Ÿ",
    "phone": "13812345678",
    "serviceDate": "2025-11-10",
    "serviceStartTime": "09:00",
    "serviceEndTime": "18:00",
    "price": 800,
    "priceType": "æœåŠ¡è´¹ç”¨",
    "images": [
      "https://example.com/image1.jpg",
      "https://example.com/image2.jpg"
    ],
    "remark": "è¯·æå‰è”ç³»å®¢æˆ·ç¡®è®¤æ—¶é—´",
    "clientInfo": {
      "id": "user123",
      "name": "å¼ å…ˆç”Ÿ",
      "avatar": "https://example.com/avatar.jpg",
      "phone": "138****5678",
      "rating": 4.8,
      "orderCount": 5
    },
    "status": 2,
    "statusText": "å¾…æ¥å•",
    "publishTime": "2025-11-10 07:00:00",
    "deadline": "2025-11-10 12:00:00",
    "requirements": [
      "éœ€è¦æºå¸¦ç›¸å…³å·¥å…·",
      "éœ€è¦ç©¿å·¥ä½œæœ"
    ]
  }
}
```

---

### 6. æœç´¢è®¢å•

**æ¥å£è¯´æ˜**ï¼šæ ¹æ®å…³é”®è¯æœç´¢å¯æ¥è®¢å•ã€‚

**æ¥å£åœ°å€**ï¼š`GET /api/engineer/orders/search`

**è¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| keyword | String | æ˜¯ | æœç´¢å…³é”®è¯ | "ç©ºè°ƒå®‰è£…" |
| page | Number | å¦ | é¡µç  | 1 |
| pageSize | Number | å¦ | æ¯é¡µæ•°é‡ | 10 |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```javascript
GET /api/engineer/orders/search?keyword=ç©ºè°ƒå®‰è£…&page=1&pageSize=10
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "list": [
      {
        "id": "20251107001",
        "orderNo": "#20251107001",
        "title": "ç©ºè°ƒå®‰è£…ç»´ä¿®æœåŠ¡",
        "address": "åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬SOHO T3åº§",
        "price": 800,
        "publishTime": "2025-11-10 07:00:00"
      }
    ],
    "total": 5,
    "page": 1,
    "pageSize": 10
  }
}
```

---

## ğŸ“Š æ•°æ®å­—æ®µè¯´æ˜

### è®¢å•ç±»å‹ï¼ˆorderTypeï¼‰

- `all`: å…¨éƒ¨è®¢å•
- `piecework`: è®¡ä»¶å·¥èµ„
- `project`: é¡¹ç›®åˆ¶
- `longterm`: é•¿æœŸåˆä½œ
- `urgent`: ç´§æ€¥è®¢å•

### è®¢å•çŠ¶æ€ï¼ˆstatusï¼‰

- `1`: å¾…ä»˜æ¬¾
- `2`: å¾…æ¥å•
- `3`: å¾…ç­¾çº¦
- `4`: å¾…æœåŠ¡
- `5`: æœåŠ¡ä¸­
- `6`: å¾…ç¡®è®¤
- `7`: å·²å®Œæˆ
- `8`: å”®åä¸­
- `9`: å·²å–æ¶ˆ

### æœåŠ¡ç±»å‹ï¼ˆserviceTypeï¼‰

- `1`: æ‰¾å”®å
- `2`: æ‰¾å”®å‰
- `3`: æ‰¾å›¢é˜Ÿ
- `4`: å”®åå·¥ç¨‹

---

## ğŸ” è®¤è¯è¦æ±‚

æ‰€æœ‰æ¥å£éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦è®¤è¯ä¿¡æ¯ï¼š

```
Authorization: Bearer {token}
```

token é€šè¿‡ç™»å½•æ¥å£è·å–ï¼Œå­˜å‚¨åœ¨æœ¬åœ°å­˜å‚¨ä¸­ã€‚

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **åˆ†é¡µå‚æ•°**ï¼šå¦‚æœæ¥å£æ”¯æŒåˆ†é¡µï¼Œå»ºè®®ä½¿ç”¨åˆ†é¡µå‚æ•°é¿å…ä¸€æ¬¡æ€§åŠ è½½è¿‡å¤šæ•°æ®ã€‚

2. **åœ¨çº¿çŠ¶æ€**ï¼šå·¥ç¨‹å¸ˆåˆ‡æ¢ä¸ºç¦»çº¿çŠ¶æ€åï¼Œç³»ç»Ÿä¸ä¼šæ¨é€æ–°è®¢å•ï¼Œä½†å¯ä»¥æŸ¥çœ‹å†å²è®¢å•ã€‚

3. **æ¥å•é™åˆ¶**ï¼š
   - æ¯ä¸ªè®¢å•åªèƒ½è¢«ä¸€ä¸ªå·¥ç¨‹å¸ˆæ¥å–
   - æ¥å•åè®¢å•çŠ¶æ€ä¼šå˜æ›´ä¸º"å¾…ç­¾çº¦"
   - å¦‚æœè®¢å•å·²è¢«å…¶ä»–å·¥ç¨‹å¸ˆæ¥å–ï¼Œä¼šè¿”å›ç›¸åº”é”™è¯¯æç¤º

4. **è·ç¦»è®¡ç®—**ï¼šå¦‚æœæä¾›äº†ç»çº¬åº¦ä¿¡æ¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—è®¢å•ä¸å·¥ç¨‹å¸ˆçš„è·ç¦»ã€‚

5. **è®¢å•ç­›é€‰**ï¼šæ”¯æŒæŒ‰è®¢å•ç±»å‹ã€æœåŠ¡ç±»å‹ã€ä¸šåŠ¡é¢†åŸŸç­‰å¤šä¸ªç»´åº¦è¿›è¡Œç­›é€‰ã€‚

6. **æ’åºæ–¹å¼**ï¼š
   - `time`: æŒ‰å‘å¸ƒæ—¶é—´æ’åº
   - `price`: æŒ‰ä»·æ ¼æ’åº
   - `distance`: æŒ‰è·ç¦»æ’åº

---

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### Vue 3 Composition API ç¤ºä¾‹

```javascript
import { get, post, put } from '@/utils/request'

// è·å–å¯æ¥è®¢å•åˆ—è¡¨
async function loadOrders(params) {
  try {
    const result = await get('/api/engineer/orders/available', params)
    return result.data
  } catch (error) {
    console.error('è·å–è®¢å•åˆ—è¡¨å¤±è´¥:', error)
    throw error
  }
}

// æ¥å•
async function acceptOrder(orderId, remark) {
  try {
    const result = await post(`/api/orders/${orderId}/accept`, { remark })
    return result.data
  } catch (error) {
    console.error('æ¥å•å¤±è´¥:', error)
    throw error
  }
}

// æ›´æ–°åœ¨çº¿çŠ¶æ€
async function updateOnlineStatus(isOnline, location) {
  try {
    const result = await put('/api/engineer/online-status', {
      isOnline,
      location
    })
    return result.data
  } catch (error) {
    console.error('æ›´æ–°çŠ¶æ€å¤±è´¥:', error)
    throw error
  }
}

// è·å–ç»Ÿè®¡æ•°æ®
async function loadStats(period = 'month') {
  try {
    const result = await get('/api/engineer/stats', { period })
    return result.data
  } catch (error) {
    console.error('è·å–ç»Ÿè®¡å¤±è´¥:', error)
    throw error
  }
}
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [è®¢å•ç›¸å…³æ¥å£æ–‡æ¡£](../api/order.js)
- [ç”¨æˆ·ç›¸å…³æ¥å£æ–‡æ¡£](../api/user.js)
- [è¯·æ±‚å°è£…è¯´æ˜](../utils/request.js)
- [API é…ç½®è¯´æ˜](../config/index.js)
