# 模拟登录功能结构图

## 整体架构

```
┌─────────────────────────────────────────────────────┐
│                   模拟登录功能                        │
│                  Mock Login System                   │
└─────────────────────────────────────────────────────┘
                         │
        ┌────────────────┼────────────────┐
        │                │                │
        ▼                ▼                ▼
   ┌─────────┐     ┌──────────┐    ┌──────────┐
   │核心工具  │     │ UI组件   │    │测试工具   │
   │  Core   │     │Component │    │  Test    │
   └─────────┘     └──────────┘    └──────────┘
```

## 详细功能模块

```
模拟登录系统
├── 核心工具层
│   └── utils/mock-login.js
│       ├── MOCK_USERS (测试账号数据)
│       │   ├── customer    (测试客户)
│       │   ├── customer2   (王小明)
│       │   ├── engineer    (测试工程师)
│       │   └── engineer2   (资深维修师)
│       │
│       ├── mockLogin()          (模拟登录)
│       ├── switchMockUser()     (快速切换)
│       ├── getMockUserList()    (获取列表)
│       ├── isMockLogin()        (检查状态)
│       └── generateMockToken()  (生成Token)
│
├── UI组件层
│   ├── pages/index/index.uvue (登录页面)
│   │   ├── 微信一键登录
│   │   ├── 授权手机号
│   │   └── 模拟登录区域
│   │       ├── 模拟客户登录按钮
│   │       └── 模拟工程师登录按钮
│   │
│   ├── components/MockUserSwitch/MockUserSwitch.uvue (切换组件)
│   │   ├── 悬浮触发按钮 (👤)
│   │   ├── 用户列表面板
│   │   │   ├── 用户头像
│   │   │   ├── 用户信息
│   │   │   ├── 角色标识
│   │   │   └── 认证状态
│   │   └── 半透明遮罩
│   │
│   └── pages/profile/profile.uvue (我的页面)
│       ├── 用户信息展示
│       ├── MockUserSwitch组件
│       └── 开发工具入口
│           └── 模拟登录测试
│
└── 测试工具层
    ├── pages/test/mock-login-demo.uvue (测试页面)
    │   ├── 当前登录状态
    │   ├── 快速登录卡片
    │   ├── 工具函数测试
    │   ├── 测试场景入口
    │   └── 操作日志显示
    │
    └── examples/mock-login-examples.js (代码示例)
        ├── 基础登录示例
        ├── 用户切换示例
        ├── 权限检查示例
        ├── 状态检查示例
        ├── 测试场景示例
        └── 实战场景组合
```

## 数据流向

```
用户操作
   │
   ▼
┌──────────────────┐
│  UI触发点         │
│  • 登录按钮       │
│  • 切换按钮       │
│  • 测试页面       │
└──────────────────┘
   │
   ▼
┌──────────────────┐
│  工具函数         │
│  mockLogin()     │
│  switchMockUser()│
└──────────────────┘
   │
   ├───────────────┐
   │               │
   ▼               ▼
┌────────┐    ┌────────┐
│生成数据 │    │模拟延迟│
│Token   │    │800ms   │
│UserInfo│    │        │
└────────┘    └────────┘
   │               │
   └───────┬───────┘
           ▼
   ┌──────────────┐
   │  存储数据     │
   │  setToken()  │
   │  setUserInfo()│
   └──────────────┘
           │
           ▼
   ┌──────────────┐
   │  UI反馈      │
   │  Toast提示   │
   │  页面跳转    │
   └──────────────┘
```

## 用户交互流程

### 流程1: 首次登录
```
┌─────────┐
│ 打开应用 │
└────┬────┘
     │
     ▼
┌─────────────┐
│  登录页面    │
│  显示按钮    │
└──────┬──────┘
       │
       ▼
┌──────────────┐     YES    ┌─────────────┐
│ 点击模拟登录  │ ────────▶ │ 显示Loading │
└──────────────┘            └──────┬──────┘
                                   │
                                   ▼
                            ┌──────────────┐
                            │ 保存登录信息  │
                            └──────┬───────┘
                                   │
                                   ▼
                            ┌──────────────┐
                            │ Toast "成功" │
                            └──────┬───────┘
                                   │
                                   ▼
                            ┌──────────────┐
                            │  跳转首页    │
                            └──────────────┘
```

### 流程2: 快速切换
```
┌─────────────┐
│  已登录状态  │
└──────┬──────┘
       │
       ▼
┌──────────────┐
│ 点击 👤 按钮  │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 弹出用户列表  │
│ • 客户1      │
│ • 客户2      │
│ • 工程师1    │
│ • 工程师2    │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 选择目标账号  │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 快速切换      │
│ (延迟300ms)  │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 刷新页面数据  │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 跳转对应首页  │
└──────────────┘
```

### 流程3: 测试页面操作
```
┌──────────────────┐
│ 访问测试页面      │
│ /pages/test/     │
│ mock-login-demo  │
└────────┬─────────┘
         │
    ┌────┴────┬────────┬─────────┐
    │         │        │         │
    ▼         ▼        ▼         ▼
┌──────┐ ┌──────┐ ┌──────┐ ┌─────────┐
│查看状态│ │快速登录│ │工具测试│ │测试场景 │
└──────┘ └──────┘ └──────┘ └─────────┘
    │         │        │         │
    └────┬────┴────┬───┴────┬────┘
         │         │        │
         ▼         ▼        ▼
    ┌────────────────────────┐
    │    实时日志显示         │
    │  • 操作记录            │
    │  • 错误信息            │
    │  • 状态变化            │
    └────────────────────────┘
```

## 文件依赖关系

```
pages/index/index.uvue
    │
    ├── import: utils/auth.js
    ├── import: utils/api.js
    ├── import: config/index.js
    └── import: utils/mock-login.js ───┐
                                       │
pages/profile/profile.uvue             │
    │                                  │
    ├── import: components/            │
    │           MockUserSwitch.uvue ───┼───┐
    └── import: utils/mock-login.js ───┤   │
                                       │   │
pages/test/mock-login-demo.uvue       │   │
    │                                  │   │
    ├── import: utils/mock-login.js ───┤   │
    └── import: utils/auth.js          │   │
                                       │   │
components/MockUserSwitch/             │   │
MockUserSwitch.uvue ───────────────────┘   │
    │                                      │
    └── import: utils/mock-login.js ───────┘

utils/mock-login.js
    │
    ├── import: utils/auth.js
    │   └── setToken()
    │   └── setUserInfo()
    │   └── navigateToHome()
    │
    └── export: mockLogin()
        export: switchMockUser()
        export: getMockUserList()
        export: isMockLogin()
        export: generateMockToken()
        export: MOCK_USERS
```

## 组件层级关系

```
App
 │
 ├── pages/
 │   │
 │   ├── index/ (登录页)
 │   │   └── [模拟登录按钮]
 │   │
 │   ├── home/ (客户首页)
 │   │
 │   ├── engineer/home/ (工程师首页)
 │   │
 │   ├── profile/ (我的)
 │   │   ├── [用户信息]
 │   │   ├── [开发工具入口]
 │   │   └── <MockUserSwitch />
 │   │
 │   └── test/mock-login-demo/ (测试页)
 │       ├── [状态显示]
 │       ├── [快速登录]
 │       ├── [工具函数]
 │       └── [测试场景]
 │
 └── components/
     └── MockUserSwitch/
         ├── [悬浮按钮]
         ├── [用户列表面板]
         └── [遮罩层]
```

## 状态管理流程

```
┌─────────────────────────────────────┐
│          LocalStorage               │
│  ┌────────────┐  ┌──────────────┐  │
│  │   token    │  │  userInfo    │  │
│  └────────────┘  └──────────────┘  │
└─────────────────────────────────────┘
         │  ▲              │  ▲
         │  │              │  │
   get() │  │ set()  get() │  │ set()
         │  │              │  │
         ▼  │              ▼  │
    ┌──────────┐      ┌──────────┐
    │ getToken │      │getUserInfo│
    │isLoggedIn│      │isCustomer│
    │isMockLogin│     │isEngineer│
    └──────────┘      └──────────┘
         │                  │
         └────────┬─────────┘
                  │
                  ▼
         ┌────────────────┐
         │   UI Components │
         │  • 显示用户信息  │
         │  • 权限控制     │
         │  • 功能切换     │
         └────────────────┘
```

## 使用场景矩阵

```
┌──────────────┬───────────┬───────────┬──────────┬──────────┐
│   场景       │  客户1    │  客户2    │ 工程师1   │ 工程师2  │
│              │(未认证)   │(已认证)   │(普通)    │(资深)    │
├──────────────┼───────────┼───────────┼──────────┼──────────┤
│ 实名认证测试  │    ✓     │     ✗    │    ✗    │    ✗     │
├──────────────┼───────────┼───────────┼──────────┼──────────┤
│ 发布工单     │    ✗     │     ✓    │    ✗    │    ✗     │
├──────────────┼───────────┼───────────┼──────────┼──────────┤
│ 接单测试     │    ✗     │     ✗    │    ✓    │    ✓     │
├──────────────┼───────────┼───────────┼──────────┼──────────┤
│ 高级功能     │    ✗     │     ✗    │    ✗    │    ✓     │
├──────────────┼───────────┼───────────┼──────────┼──────────┤
│ VIP特权      │    ✗     │     ✓    │    ✓    │    ✓     │
└──────────────┴───────────┴───────────┴──────────┴──────────┘

✓ = 推荐使用该账号测试此场景
✗ = 不适合使用该账号测试此场景
```

## 安全性考虑

```
开发环境
    │
    ├── ✓ 启用模拟登录
    ├── ✓ 显示所有入口
    ├── ✓ 显示开发工具
    └── ✓ 详细日志输出
    
生产环境
    │
    ├── ✗ 禁用模拟登录
    ├── ✗ 隐藏所有入口
    ├── ✗ 移除开发工具
    └── ✗ 最小化日志
```

## 扩展建议

```
当前功能
    │
    ├── 4个测试账号
    ├── 基础登录切换
    ├── UI组件
    └── 测试页面
    
未来扩展
    │
    ├── 更多测试账号
    │   ├── 不同地区
    │   ├── 不同权限
    │   └── 特殊状态
    │
    ├── 模拟API响应
    │   ├── 成功场景
    │   ├── 失败场景
    │   └── 网络延迟
    │
    ├── 数据生成器
    │   ├── 订单数据
    │   ├── 消息数据
    │   └── 统计数据
    │
    └── 自动化测试
        ├── 场景录制
        ├── 回放测试
        └── 性能监控
```

---

**版本**: 1.0.0  
**创建日期**: 2025-11-20  
**作者**: AI Assistant

