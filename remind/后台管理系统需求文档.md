# åå°ç®¡ç†ç³»ç»Ÿéœ€æ±‚æ–‡æ¡£

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

åå°ç®¡ç†ç³»ç»ŸåŒ…æ‹¬**æœåŠ¡å•†ç®¡ç†ç«¯**å’Œ**å¹³å°ç®¡ç†ç«¯**ä¸¤ä¸ªéƒ¨åˆ†ï¼Œç”¨äºç®¡ç†è®¢å•ã€ç”¨æˆ·ã€å·¥ç¨‹å¸ˆç­‰æ ¸å¿ƒä¸šåŠ¡ã€‚

---

## 3.3 æœåŠ¡å•†ç®¡ç†ç«¯

æœåŠ¡å•†ç®¡ç†ç«¯ä¾›å„æœåŠ¡å•†ç®¡ç†å‘˜ä½¿ç”¨ï¼Œç®¡ç†è‡ªå·±çš„è®¢å•ã€å·¥ç¨‹å¸ˆå’Œå®¢æˆ·ã€‚

### 3.3.2 æ´¾å•ç®¡ç†

#### åŠŸèƒ½æ¦‚è¿°
æœåŠ¡å•†æ¥åˆ°è®¢å•åï¼Œå°†è®¢å•æ´¾å‘ç»™æ——ä¸‹å·¥ç¨‹å¸ˆè¿›è¡ŒæœåŠ¡ã€‚

#### æ´¾å•è§„åˆ™

##### 1. å¤šäººåä½œæœåŠ¡
- **æ”¯æŒåœºæ™¯**ï¼šå¤§å‹é¡¹ç›®ã€å¤æ‚ä»»åŠ¡
- **åŠŸèƒ½**ï¼š
  - å¯é€‰æ‹©å¤šä¸ªå·¥ç¨‹å¸ˆåŒæ—¶æœåŠ¡ä¸€ä¸ªè®¢å•
  - å¯æŒ‡å®šä¸»å·¥ç¨‹å¸ˆå’Œè¾…åŠ©å·¥ç¨‹å¸ˆ
  - å¯è®¾ç½®æ¯ä¸ªå·¥ç¨‹å¸ˆçš„å·¥ä½œå†…å®¹
  - å¯è®¾ç½®å·¥ä½œæ¯”ä¾‹ï¼ˆç”¨äºåˆ†é…æŠ¥é…¬ï¼‰

##### 2. æ¥å•ç¡®è®¤æœºåˆ¶
- **å¼ºåˆ¶æ¥å•**ï¼šå·¥ç¨‹å¸ˆå¿…é¡»æ¥å•åæ‰èƒ½å¼€å§‹æœåŠ¡
- **æ¥å•æµç¨‹**ï¼š
  1. æœåŠ¡å•†æ´¾å•ç»™å·¥ç¨‹å¸ˆ
  2. å·¥ç¨‹å¸ˆæ”¶åˆ°æ´¾å•é€šçŸ¥
  3. å·¥ç¨‹å¸ˆç¡®è®¤æ¥å•æˆ–æ‹’ç»
  4. æ‹’ç»éœ€è¯´æ˜åŸå› 
  5. æ‹’ç»åå¯é‡æ–°æ´¾å•

##### 3. æ´¾å•è°ƒæ•´
- **è°ƒæ•´åœºæ™¯**ï¼š
  - å·¥ç¨‹å¸ˆæ‹’ç»æ¥å•
  - å·¥ç¨‹å¸ˆä¸´æ—¶æœ‰äº‹
  - å·¥ç¨‹å¸ˆèƒ½åŠ›ä¸åŒ¹é…
  - å®¢æˆ·è¦æ±‚æ›´æ¢
- **è°ƒæ•´åŠŸèƒ½**ï¼š
  - å¢åŠ å·¥ç¨‹å¸ˆ
  - ç§»é™¤å·¥ç¨‹å¸ˆ
  - æ›´æ¢å·¥ç¨‹å¸ˆ
  - è°ƒæ•´å·¥ä½œåˆ†é…

#### æ•°æ®ç»“æ„

```typescript
// æ´¾å•è®°å½•
interface Assignment {
  id: string
  order_id: string
  engineers: {
    engineer_id: string
    engineer_name: string
    role: 'primary' | 'assistant'  // ä¸»å·¥ç¨‹å¸ˆ/è¾…åŠ©å·¥ç¨‹å¸ˆ
    work_content: string           // å·¥ä½œå†…å®¹
    work_ratio: number             // å·¥ä½œæ¯”ä¾‹ï¼ˆ%ï¼‰
    status: 'pending' | 'accepted' | 'rejected'
    accept_time?: string
    reject_reason?: string
  }[]
  assign_time: string
  assign_by: string
  status: string
}
```

#### é¡µé¢åŠŸèƒ½

##### æ´¾å•é¡µé¢
- **è®¢å•ä¿¡æ¯å±•ç¤º**ï¼š
  - è®¢å•å·ã€å®¢æˆ·ä¿¡æ¯
  - æœåŠ¡ç±»å‹ã€ä¸šåŠ¡é¢†åŸŸ
  - æœåŠ¡åœ°å€ã€è”ç³»æ–¹å¼
  - è¯¦ç»†æè¿°ã€å›¾ç‰‡

- **å·¥ç¨‹å¸ˆé€‰æ‹©**ï¼š
  - å¯æœç´¢å·¥ç¨‹å¸ˆ
  - æ˜¾ç¤ºå·¥ç¨‹å¸ˆä¿¡æ¯ï¼ˆå§“åã€æŠ€èƒ½ã€è¯„åˆ†ã€å½“å‰çŠ¶æ€ï¼‰
  - å¤šé€‰å·¥ç¨‹å¸ˆ
  - è®¾ç½®ä¸»è¾…è§’è‰²

- **å·¥ä½œåˆ†é…**ï¼š
  - ä¸ºæ¯ä¸ªå·¥ç¨‹å¸ˆè®¾ç½®å·¥ä½œå†…å®¹
  - è®¾ç½®å·¥ä½œæ¯”ä¾‹ï¼ˆè‡ªåŠ¨è®¡ç®—æ€»å’Œ100%ï¼‰
  - æ·»åŠ å¤‡æ³¨è¯´æ˜

- **æ´¾å•æ“ä½œ**ï¼š
  - ç¡®è®¤æ´¾å•æŒ‰é’®
  - å‘é€é€šçŸ¥ç»™å·¥ç¨‹å¸ˆ

##### æ´¾å•åˆ—è¡¨é¡µé¢
- **åˆ—è¡¨å±•ç¤º**ï¼š
  - è®¢å•å·ã€å®¢æˆ·ã€æœåŠ¡ç±»å‹
  - å·¥ç¨‹å¸ˆåˆ—è¡¨ï¼ˆå¤´åƒ+å§“åï¼‰
  - æ¥å•çŠ¶æ€ï¼ˆå·²æ¥å•/å¾…æ¥å•/å·²æ‹’ç»ï¼‰
  - æ´¾å•æ—¶é—´

- **ç­›é€‰æ¡ä»¶**ï¼š
  - æŒ‰çŠ¶æ€ç­›é€‰
  - æŒ‰å·¥ç¨‹å¸ˆç­›é€‰
  - æŒ‰æ—¶é—´èŒƒå›´ç­›é€‰

- **æ“ä½œæŒ‰é’®**ï¼š
  - æŸ¥çœ‹è¯¦æƒ…
  - è°ƒæ•´æ´¾å•
  - å–æ¶ˆæ´¾å•

##### æ´¾å•è°ƒæ•´é¡µé¢
- **å½“å‰æ´¾å•ä¿¡æ¯**ï¼šæ˜¾ç¤ºå·²æ´¾å·¥ç¨‹å¸ˆ
- **è°ƒæ•´æ“ä½œ**ï¼š
  - æ·»åŠ å·¥ç¨‹å¸ˆ
  - ç§»é™¤å·¥ç¨‹å¸ˆ
  - æ›´æ¢å·¥ç¨‹å¸ˆ
  - è°ƒæ•´å·¥ä½œåˆ†é…
- **è°ƒæ•´è®°å½•**ï¼šè®°å½•æ‰€æœ‰è°ƒæ•´å†å²

---

### 3.3.3 è®¢å•å®¡æ ¸

#### åŠŸèƒ½æ¦‚è¿°
å·¥ç¨‹å¸ˆå®ŒæˆæœåŠ¡åæäº¤å®Œæˆç”³è¯·ï¼Œéœ€è¦ç»è¿‡æœåŠ¡å•†å®¡æ ¸å’Œå¹³å°å®¡æ ¸ã€‚

#### å®¡æ ¸æµç¨‹

```
å·¥ç¨‹å¸ˆæäº¤å®Œæˆç”³è¯·
    â†“
æœåŠ¡å•†ç®¡ç†å‘˜å®¡æ ¸
    â”œâ”€ å®¡æ ¸é€šè¿‡ â†’ æäº¤å¹³å°å®¡æ ¸
    â””â”€ å®¡æ ¸æ‹’ç» â†’ è¿”å›å·¥ç¨‹å¸ˆä¿®æ”¹
              â†“
        å¹³å°å®¡æ ¸
    â”œâ”€ å®¡æ ¸é€šè¿‡ â†’ è®¢å•å®Œæˆ
    â””â”€ å®¡æ ¸æ‹’ç» â†’ è¿”å›æœåŠ¡å•†é‡æ–°å®¡æ ¸
```

#### æœåŠ¡å•†å®¡æ ¸

##### 1. å®¡æ ¸å†…å®¹
- **æœåŠ¡å®Œæˆè¯æ˜**ï¼š
  - ç°åœºç…§ç‰‡
  - å®ŒæˆæŠ¥å‘Š
  - å®¢æˆ·ç­¾å­—ï¼ˆç”µå­ç­¾åï¼‰
  
- **æœåŠ¡è´¨é‡æ£€æŸ¥**ï¼š
  - æœåŠ¡æ˜¯å¦æŒ‰è¦æ±‚å®Œæˆ
  - å®¢æˆ·æ˜¯å¦æ»¡æ„
  - æ˜¯å¦æœ‰é—ç•™é—®é¢˜

- **è´¹ç”¨æ ¸å¯¹**ï¼š
  - æœåŠ¡è´¹ç”¨
  - ææ–™è´¹ç”¨
  - å…¶ä»–è´¹ç”¨

##### 2. å®¡æ ¸æ“ä½œ
- **å®¡æ ¸é€šè¿‡**ï¼š
  - ç¡®è®¤æœåŠ¡å®Œæˆ
  - å¡«å†™å®¡æ ¸æ„è§
  - æäº¤å¹³å°å®¡æ ¸

- **å®¡æ ¸æ‹’ç»**ï¼š
  - è¯´æ˜æ‹’ç»åŸå› 
  - æŒ‡å‡ºéœ€è¦æ”¹è¿›çš„åœ°æ–¹
  - é€€å›å·¥ç¨‹å¸ˆé‡æ–°æäº¤

- **è¡¥å……ææ–™**ï¼š
  - è¦æ±‚å·¥ç¨‹å¸ˆè¡¥å……ç…§ç‰‡
  - è¦æ±‚è¡¥å……è¯´æ˜æ–‡æ¡£
  - è¦æ±‚å®¢æˆ·å†æ¬¡ç¡®è®¤

#### å¹³å°å®¡æ ¸

##### 1. å®¡æ ¸å†…å®¹
- **æœåŠ¡åˆè§„æ€§**ï¼š
  - æ˜¯å¦ç¬¦åˆå¹³å°è§„èŒƒ
  - æ˜¯å¦å­˜åœ¨è¿è§„è¡Œä¸º
  - å®¢æˆ·æŠ•è¯‰æƒ…å†µ

- **è´¨é‡æŠ½æŸ¥**ï¼š
  - éšæœºæŠ½æŸ¥æœåŠ¡è´¨é‡
  - å›è®¿å®¢æˆ·æ»¡æ„åº¦
  - æ£€æŸ¥å®Œæˆææ–™

- **è´¹ç”¨å®¡æ ¸**ï¼š
  - è´¹ç”¨æ˜¯å¦åˆç†
  - æ˜¯å¦å­˜åœ¨ä¹±æ”¶è´¹
  - å‘ç¥¨å¼€å…·æƒ…å†µ

##### 2. å®¡æ ¸æ“ä½œ
- **å®¡æ ¸é€šè¿‡**ï¼š
  - è®¢å•çŠ¶æ€æ›´æ–°ä¸º"å·²å®Œæˆ"
  - è§¦å‘ç»“ç®—æµç¨‹
  - è§£å†»æœåŠ¡è´¹ç”¨

- **å®¡æ ¸æ‹’ç»**ï¼š
  - è¯´æ˜æ‹’ç»åŸå› 
  - è¿”å›æœåŠ¡å•†é‡æ–°å®¡æ ¸
  - å¿…è¦æ—¶ä»‹å…¥åè°ƒ

#### æ•°æ®ç»“æ„

```typescript
// å®Œæˆç”³è¯·
interface CompletionRequest {
  id: string
  order_id: string
  engineer_id: string
  submit_time: string
  
  // å®Œæˆææ–™
  completion_photos: string[]      // å®Œæˆç…§ç‰‡
  completion_report: string        // å®ŒæˆæŠ¥å‘Š
  customer_signature: string       // å®¢æˆ·ç­¾å
  
  // æœåŠ¡å•†å®¡æ ¸
  vendor_review: {
    status: 'pending' | 'approved' | 'rejected'
    reviewer: string
    review_time: string
    review_comment: string
    reject_reason?: string
  }
  
  // å¹³å°å®¡æ ¸
  platform_review: {
    status: 'pending' | 'approved' | 'rejected'
    reviewer: string
    review_time: string
    review_comment: string
    reject_reason?: string
  }
}
```

#### é¡µé¢åŠŸèƒ½

##### å¾…å®¡æ ¸åˆ—è¡¨é¡µé¢
- **åˆ—è¡¨å±•ç¤º**ï¼š
  - è®¢å•å·ã€å®¢æˆ·ã€æœåŠ¡ç±»å‹
  - å·¥ç¨‹å¸ˆå§“å
  - æäº¤æ—¶é—´
  - å®¡æ ¸çŠ¶æ€

- **ç­›é€‰æ¡ä»¶**ï¼š
  - æŒ‰å®¡æ ¸çŠ¶æ€ç­›é€‰
  - æŒ‰å·¥ç¨‹å¸ˆç­›é€‰
  - æŒ‰æ—¶é—´ç­›é€‰

- **æ“ä½œæŒ‰é’®**ï¼š
  - å®¡æ ¸
  - æŸ¥çœ‹è¯¦æƒ…

##### å®¡æ ¸è¯¦æƒ…é¡µé¢
- **è®¢å•ä¿¡æ¯**ï¼š
  - åŸºæœ¬ä¿¡æ¯
  - æœåŠ¡è¯¦æƒ…
  - è´¹ç”¨æ˜ç»†

- **å®Œæˆææ–™**ï¼š
  - å®Œæˆç…§ç‰‡æŸ¥çœ‹
  - å®ŒæˆæŠ¥å‘Šé˜…è¯»
  - å®¢æˆ·ç­¾åæŸ¥çœ‹

- **å®¡æ ¸æ“ä½œ**ï¼š
  - å®¡æ ¸é€šè¿‡æŒ‰é’®
  - å®¡æ ¸æ‹’ç»æŒ‰é’®
  - è¦æ±‚è¡¥å……ææ–™æŒ‰é’®
  - å®¡æ ¸æ„è§è¾“å…¥æ¡†

##### å®¡æ ¸å†å²é¡µé¢
- **å®¡æ ¸è®°å½•åˆ—è¡¨**
- **å®¡æ ¸ç»Ÿè®¡**ï¼š
  - é€šè¿‡ç‡
  - å¹³å‡å®¡æ ¸æ—¶é•¿
  - æ‹’ç»åŸå› ç»Ÿè®¡

---

### 3.3.4 èŠå¤©åŠŸèƒ½

#### åŠŸèƒ½æ¦‚è¿°
æ”¯æŒå®¢æˆ·ã€é¡¹ç›®ç»ç†ã€å·¥ç¨‹å¸ˆä¹‹é—´çš„å®æ—¶æ²Ÿé€šï¼Œé‡‡ç”¨ç¾¤èŠæ¨¡å¼ã€‚

#### æ²Ÿé€šæ–¹å¼

##### 1. ç¾¤èŠæ¨¡å¼
**å‚ä¸äººå‘˜**ï¼š
- å®¢æˆ·ï¼ˆè®¢å•å‘èµ·äººï¼‰
- é¡¹ç›®ç»ç†ï¼ˆæœåŠ¡å•†ç®¡ç†å‘˜ï¼‰
- å·¥ç¨‹å¸ˆï¼ˆ1ä¸ªæˆ–å¤šä¸ªï¼‰

**ç¾¤èŠè§„åˆ™**ï¼š
- æ¯ä¸ªè®¢å•è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªç¾¤èŠ
- æ‰€æœ‰å‚ä¸äººå‘˜è‡ªåŠ¨åŠ å…¥
- ç¾¤èŠåç§°ï¼šè®¢å•å· + æœåŠ¡ç±»å‹
- å·¥ç¨‹å¸ˆæ›´æ¢æ—¶è‡ªåŠ¨æ›´æ–°ç¾¤æˆå‘˜

##### 2. æ¶ˆæ¯ç±»å‹
**æ”¯æŒçš„æ¶ˆæ¯ç±»å‹**ï¼š
- âœ… æ–‡å­—æ¶ˆæ¯
- âœ… å›¾ç‰‡æ¶ˆæ¯
- ğŸ“‹ æ–‡ä»¶æ¶ˆæ¯ï¼ˆV2ï¼‰
- ğŸ“ ä½ç½®æ¶ˆæ¯ï¼ˆV2ï¼‰
- ğŸ¤ è¯­éŸ³æ¶ˆæ¯ï¼ˆV2ï¼‰
- ğŸ“¹ è§†é¢‘æ¶ˆæ¯ï¼ˆV2ï¼‰

**å½“å‰ç‰ˆæœ¬æ”¯æŒ**ï¼š
- æ–‡å­—æ¶ˆæ¯
- å›¾ç‰‡æ¶ˆæ¯ï¼ˆæ”¯æŒå‘é€ã€é¢„è§ˆã€ä¿å­˜ï¼‰

#### æŠ€æœ¯æ–¹æ¡ˆ

##### æ–¹æ¡ˆ1ï¼šWebSocket å®æ—¶é€šä¿¡ï¼ˆæ¨èï¼‰
```typescript
// WebSocketè¿æ¥
const ws = new WebSocket('wss://api.example.com/chat')

// å‘é€æ¶ˆæ¯
ws.send(JSON.stringify({
  type: 'message',
  order_id: 'xxx',
  content: 'xxx',
  message_type: 'text'
}))

// æ¥æ”¶æ¶ˆæ¯
ws.onmessage = (event) => {
  const message = JSON.parse(event.data)
  // å¤„ç†æ¶ˆæ¯
}
```

##### æ–¹æ¡ˆ2ï¼šè½®è¯¢ï¼ˆå¤‡é€‰ï¼‰
```typescript
// å®šæ—¶è·å–æ–°æ¶ˆæ¯
setInterval(() => {
  fetchNewMessages(order_id)
}, 3000)
```

#### æ•°æ®ç»“æ„

```typescript
// èŠå¤©å®¤
interface ChatRoom {
  id: string
  order_id: string
  order_no: string
  service_type: string
  
  members: {
    user_id: string
    user_name: string
    user_type: 'customer' | 'manager' | 'engineer'
    avatar: string
    join_time: string
  }[]
  
  create_time: string
  last_message: Message
  unread_count: number
}

// æ¶ˆæ¯
interface Message {
  id: string
  room_id: string
  sender_id: string
  sender_name: string
  sender_type: 'customer' | 'manager' | 'engineer'
  
  message_type: 'text' | 'image' | 'file'
  content: string          // æ–‡å­—å†…å®¹æˆ–å›¾ç‰‡URL
  
  send_time: string
  read_by: string[]        // å·²è¯»ç”¨æˆ·IDåˆ—è¡¨
}
```

#### é¡µé¢åŠŸèƒ½

##### èŠå¤©å®¤åˆ—è¡¨é¡µé¢
- **åˆ—è¡¨å±•ç¤º**ï¼š
  - è®¢å•å· + æœåŠ¡ç±»å‹
  - æœ€åä¸€æ¡æ¶ˆæ¯
  - æœªè¯»æ¶ˆæ¯æ•°
  - æœ€åæ¶ˆæ¯æ—¶é—´

- **ç­›é€‰æ¡ä»¶**ï¼š
  - æŒ‰æœªè¯»ç­›é€‰
  - æŒ‰æ—¶é—´æ’åº

- **æ“ä½œ**ï¼š
  - ç‚¹å‡»è¿›å…¥èŠå¤©å®¤
  - åˆ é™¤èŠå¤©è®°å½•

##### èŠå¤©é¡µé¢
- **é¡¶éƒ¨ä¿¡æ¯**ï¼š
  - è®¢å•å·
  - æˆå‘˜åˆ—è¡¨ï¼ˆå¤´åƒï¼‰
  - æˆå‘˜æ•°é‡

- **æ¶ˆæ¯åŒºåŸŸ**ï¼š
  - æ¶ˆæ¯æ°”æ³¡ï¼ˆå·¦å³åˆ†å¸ƒï¼‰
  - å‘é€è€…å§“å + è§’è‰²æ ‡è¯†
  - æ¶ˆæ¯æ—¶é—´
  - å·²è¯»/æœªè¯»çŠ¶æ€

- **è¾“å…¥åŒºåŸŸ**ï¼š
  - æ–‡å­—è¾“å…¥æ¡†
  - å›¾ç‰‡é€‰æ‹©æŒ‰é’®
  - å‘é€æŒ‰é’®

- **åŠŸèƒ½æŒ‰é’®**ï¼š
  - æŸ¥çœ‹è®¢å•è¯¦æƒ…
  - æŸ¥çœ‹æˆå‘˜åˆ—è¡¨
  - æ¸…ç©ºèŠå¤©è®°å½•

#### æ¶ˆæ¯æ¨é€

##### 1. ç«™å†…é€šçŸ¥
- æ–°æ¶ˆæ¯æé†’
- æœªè¯»æ¶ˆæ¯æ•°é‡
- æ¶ˆæ¯é¢„è§ˆ

##### 2. å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯
- é‡è¦æ¶ˆæ¯é€šçŸ¥
- å¦‚ï¼šå·¥ç¨‹å¸ˆå·²æ¥å•ã€æœåŠ¡å³å°†å¼€å§‹ç­‰

##### 3. çŸ­ä¿¡é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
- ç´§æ€¥æ¶ˆæ¯
- ç”¨æˆ·é•¿æ—¶é—´æœªè¯»æ—¶å‘é€

---

## 3.4 å¹³å°ç®¡ç†ç«¯

å¹³å°ç®¡ç†ç«¯ä¾›å¹³å°è¿è¥äººå‘˜ä½¿ç”¨ï¼Œç®¡ç†æ•´ä¸ªå¹³å°çš„ä¾›åº”å•†ã€å®¢æˆ·ã€å·¥ç¨‹å¸ˆç­‰ã€‚

### 3.4.1 ä¾›åº”å•†ç®¡ç†

#### åŠŸèƒ½æ¦‚è¿°
ç®¡ç†å¹³å°ä¸Šçš„æ‰€æœ‰ä¾›åº”å•†ï¼ˆæœåŠ¡å•†ï¼‰ï¼ŒåŒ…æ‹¬å®¡æ ¸ã€å¯ç”¨/ç¦ç”¨ã€ç®¡ç†å‘˜ç®¡ç†ç­‰ã€‚

#### ä¾›åº”å•†ç”³è¯·å®¡æ ¸

##### å®¡æ ¸æµç¨‹
```
ä¾›åº”å•†æäº¤å…¥é©»ç”³è¯·
    â†“
å¹³å°å®¡æ ¸èµ„è´¨
    â”œâ”€ å®¡æ ¸é€šè¿‡ â†’ å¼€é€šè´¦å·
    â””â”€ å®¡æ ¸æ‹’ç» â†’ é€šçŸ¥åŸå› 
```

##### å®¡æ ¸å†…å®¹
**åŸºæœ¬ä¿¡æ¯**ï¼š
- å…¬å¸åç§°
- ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç 
- æ³•äººä»£è¡¨
- æ³¨å†Œåœ°å€
- è”ç³»æ–¹å¼

**èµ„è´¨è¯æ˜**ï¼š
- è¥ä¸šæ‰§ç…§
- ç›¸å…³èµ„è´¨è¯ä¹¦
- æ¡ˆä¾‹å±•ç¤º
- å·¥ç¨‹å¸ˆå›¢é˜Ÿ

**æœåŠ¡èƒ½åŠ›**ï¼š
- æœåŠ¡åŒºåŸŸ
- ä¸šåŠ¡é¢†åŸŸ
- å·¥ç¨‹å¸ˆæ•°é‡
- æœåŠ¡ç»éªŒ

##### å®¡æ ¸æ“ä½œ
- **é€šè¿‡**ï¼š
  - åˆ›å»ºä¾›åº”å•†è´¦å·
  - å¼€é€šç®¡ç†å‘˜è´¦å·
  - å‘é€é€šçŸ¥

- **æ‹’ç»**ï¼š
  - è¯´æ˜æ‹’ç»åŸå› 
  - æŒ‡å‡ºéœ€è¦æ”¹è¿›çš„åœ°æ–¹
  - å…è®¸é‡æ–°ç”³è¯·

#### ä¾›åº”å•†åˆ—è¡¨

##### åˆ—è¡¨å±•ç¤º
- **åŸºæœ¬ä¿¡æ¯**ï¼š
  - å…¬å¸åç§°
  - è”ç³»äºº
  - è”ç³»ç”µè¯
  - å…¥é©»æ—¶é—´

- **ä¸šåŠ¡æ•°æ®**ï¼š
  - è®¢å•æ€»æ•°
  - å®Œæˆè®¢å•æ•°
  - å·¥ç¨‹å¸ˆæ•°é‡
  - å®¢æˆ·è¯„åˆ†

- **çŠ¶æ€æ ‡è¯†**ï¼š
  - å¯ç”¨/ç¦ç”¨
  - è®¤è¯ç­‰çº§
  - ä¿¡èª‰è¯„åˆ†

##### ç­›é€‰æ¡ä»¶
- æŒ‰çŠ¶æ€ç­›é€‰ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
- æŒ‰ä¸šåŠ¡é¢†åŸŸç­›é€‰
- æŒ‰åœ°åŒºç­›é€‰
- æŒ‰å…¥é©»æ—¶é—´ç­›é€‰

##### æ“ä½œæŒ‰é’®
- æŸ¥çœ‹è¯¦æƒ…
- ç¼–è¾‘ä¿¡æ¯
- å¯ç”¨/ç¦ç”¨
- æŸ¥çœ‹è®¢å•
- æŸ¥çœ‹å·¥ç¨‹å¸ˆ

#### ä¾›åº”å•†ç®¡ç†å‘˜ç®¡ç†

##### ç®¡ç†å‘˜åˆ—è¡¨
- **ä¿¡æ¯å±•ç¤º**ï¼š
  - å§“å
  - æ‰‹æœºå·
  - è§’è‰²ï¼ˆè¶…çº§ç®¡ç†å‘˜/æ™®é€šç®¡ç†å‘˜ï¼‰
  - æƒé™èŒƒå›´
  - æœ€åç™»å½•æ—¶é—´

- **æƒé™ç®¡ç†**ï¼š
  - è®¢å•ç®¡ç†æƒé™
  - å·¥ç¨‹å¸ˆç®¡ç†æƒé™
  - è´¢åŠ¡æŸ¥çœ‹æƒé™
  - æ•°æ®å¯¼å‡ºæƒé™

##### æ“ä½œåŠŸèƒ½
- æ·»åŠ ç®¡ç†å‘˜
- ç¼–è¾‘ç®¡ç†å‘˜ä¿¡æ¯
- é‡ç½®å¯†ç 
- è®¾ç½®æƒé™
- åˆ é™¤ç®¡ç†å‘˜

#### ä¾›åº”å•†çŠ¶æ€ç®¡ç†

##### å¯ç”¨ä¾›åº”å•†
- ä¾›åº”å•†å¯æ­£å¸¸æ¥å•
- å·¥ç¨‹å¸ˆå¯æ­£å¸¸æœåŠ¡
- æ˜¾ç¤ºåœ¨ä¾›åº”å•†åˆ—è¡¨

##### ç¦ç”¨ä¾›åº”å•†
- **ç¦ç”¨åŸå› **ï¼š
  - è¿è§„æ“ä½œ
  - æœåŠ¡è´¨é‡å·®
  - å®¢æˆ·æŠ•è¯‰å¤š
  - é•¿æœŸä¸æ´»è·ƒ

- **ç¦ç”¨åæœ**ï¼š
  - æ— æ³•æ¥æ”¶æ–°è®¢å•
  - ç°æœ‰è®¢å•ç»§ç»­å®Œæˆ
  - ä¸æ˜¾ç¤ºåœ¨ä¾›åº”å•†åˆ—è¡¨
  - å·¥ç¨‹å¸ˆæ— æ³•æ¥å•

##### çŠ¶æ€å˜æ›´è®°å½•
- è®°å½•æ‰€æœ‰çŠ¶æ€å˜æ›´
- å˜æ›´æ—¶é—´ã€æ“ä½œäºº
- å˜æ›´åŸå› 

#### æ•°æ®ç»“æ„

```typescript
// ä¾›åº”å•†
interface Vendor {
  id: string
  company_name: string
  credit_code: string          // ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç 
  legal_person: string         // æ³•äººä»£è¡¨
  address: string
  contact_person: string
  contact_phone: string
  
  // èµ„è´¨ä¿¡æ¯
  business_license: string     // è¥ä¸šæ‰§ç…§
  certificates: string[]       // èµ„è´¨è¯ä¹¦
  case_photos: string[]        // æ¡ˆä¾‹ç…§ç‰‡
  
  // æœåŠ¡èƒ½åŠ›
  service_areas: string[]      // æœåŠ¡åŒºåŸŸ
  business_domains: number[]   // ä¸šåŠ¡é¢†åŸŸID
  engineer_count: number       // å·¥ç¨‹å¸ˆæ•°é‡
  
  // çŠ¶æ€ä¿¡æ¯
  status: 'pending' | 'active' | 'disabled'
  credit_score: number         // ä¿¡èª‰è¯„åˆ†
  join_time: string
  
  // ä¸šåŠ¡ç»Ÿè®¡
  total_orders: number
  completed_orders: number
  customer_rating: number
}

// ä¾›åº”å•†ç®¡ç†å‘˜
interface VendorAdmin {
  id: string
  vendor_id: string
  name: string
  phone: string
  role: 'super' | 'normal'
  permissions: string[]
  create_time: string
  last_login: string
}
```

---

### 3.4.2 å®¢æˆ·ç®¡ç†

#### åŠŸèƒ½æ¦‚è¿°
ç®¡ç†å¹³å°ä¸Šçš„æ‰€æœ‰å®¢æˆ·ï¼ŒæŸ¥è¯¢å®¢æˆ·ä¿¡æ¯ã€è®¢å•ç»Ÿè®¡ã€æ ‡ç­¾ç®¡ç†ç­‰ã€‚

#### å®¢æˆ·åˆ—è¡¨

##### åˆ—è¡¨å±•ç¤º
- **åŸºæœ¬ä¿¡æ¯**ï¼š
  - æ˜µç§°/å§“å
  - æ‰‹æœºå·
  - æ³¨å†Œæ—¶é—´
  - æœ€åç™»å½•æ—¶é—´

- **å®åè®¤è¯**ï¼š
  - è®¤è¯çŠ¶æ€
  - çœŸå®å§“å
  - èº«ä»½è¯å·ï¼ˆè„±æ•ï¼‰

- **ä¸šåŠ¡æ•°æ®**ï¼š
  - è®¢å•æ€»æ•°
  - ç´¯è®¡æ¶ˆè´¹
  - VIPç­‰çº§
  - å®¢æˆ·æ ‡ç­¾

##### ç­›é€‰æ¡ä»¶
- æŒ‰è®¤è¯çŠ¶æ€ç­›é€‰
- æŒ‰VIPç­‰çº§ç­›é€‰
- æŒ‰æ ‡ç­¾ç­›é€‰
- æŒ‰æ³¨å†Œæ—¶é—´ç­›é€‰

##### æ“ä½œæŒ‰é’®
- æŸ¥çœ‹è¯¦æƒ…
- æŸ¥çœ‹è®¢å•
- æ·»åŠ æ ‡ç­¾
- æŸ¥çœ‹å…¬å¸ä¿¡æ¯

#### å®¢æˆ·ä¿¡æ¯æŸ¥è¯¢

##### åŸºæœ¬ä¿¡æ¯
- ä¸ªäººä¿¡æ¯
- è”ç³»æ–¹å¼
- å®åè®¤è¯ä¿¡æ¯
- æ³¨å†Œæ¥æº

##### å…¬å¸ä¿¡æ¯
**å®¢æˆ·å¯å…³è”å…¬å¸**ï¼š
- å…¬å¸åç§°
- å…¬å¸è§„æ¨¡
- æ‰€å±è¡Œä¸š
- å…¬å¸åœ°å€
- ä¸šåŠ¡è”ç³»äºº

**ä¸€ä¸ªå®¢æˆ·å¯ä»¥æœ‰å¤šä¸ªå…¬å¸**ï¼š
- æŸ¥çœ‹æ‰€æœ‰å…¬å¸åˆ—è¡¨
- æ¯ä¸ªå…¬å¸çš„è®¢å•ç»Ÿè®¡
- å…¬å¸è®¤è¯çŠ¶æ€

##### è´¦å·ä¿¡æ¯
- è´¦å·çŠ¶æ€ï¼ˆæ­£å¸¸/å†»ç»“ï¼‰
- ç™»å½•æ—¥å¿—
- æ“ä½œæ—¥å¿—
- è®¾å¤‡ä¿¡æ¯

#### å®¢æˆ·è®¢å•ç»Ÿè®¡

##### è®¢å•æ¦‚è§ˆ
- **æ€»ä½“ç»Ÿè®¡**ï¼š
  - è®¢å•æ€»æ•°
  - å®Œæˆè®¢å•
  - è¿›è¡Œä¸­è®¢å•
  - å·²å–æ¶ˆè®¢å•

- **æ¶ˆè´¹ç»Ÿè®¡**ï¼š
  - ç´¯è®¡æ¶ˆè´¹é‡‘é¢
  - å¹³å‡è®¢å•é‡‘é¢
  - æœ€é«˜è®¢å•é‡‘é¢
  - æœ€è¿‘30å¤©æ¶ˆè´¹

##### è®¢å•åˆ†æ
- **æ—¶é—´åˆ†æ**ï¼š
  - æŒ‰æœˆè®¢å•è¶‹åŠ¿
  - æŒ‰å­£åº¦è®¢å•è¶‹åŠ¿

- **ç±»å‹åˆ†æ**ï¼š
  - æŒ‰æœåŠ¡ç±»å‹ç»Ÿè®¡
  - æŒ‰ä¸šåŠ¡é¢†åŸŸç»Ÿè®¡

- **è¯„ä»·åˆ†æ**ï¼š
  - å¹³å‡è¯„åˆ†
  - å¥½è¯„ç‡
  - æŠ•è¯‰æ¬¡æ•°

#### å®¢æˆ·æ ‡ç­¾ç®¡ç†

##### æ ‡ç­¾ç±»å‹
**ç³»ç»Ÿæ ‡ç­¾**ï¼ˆè‡ªåŠ¨æ‰“æ ‡ç­¾ï¼‰ï¼š
- é«˜ä»·å€¼å®¢æˆ·ï¼šæ¶ˆè´¹é‡‘é¢ > 10000
- æ´»è·ƒå®¢æˆ·ï¼šæœˆè®¢å• > 5
- æ–°å®¢æˆ·ï¼šæ³¨å†Œ < 30å¤©
- æ²‰ç¡å®¢æˆ·ï¼š90å¤©æ— è®¢å•
- VIPå®¢æˆ·ï¼šVIPç­‰çº§ > 0

**è‡ªå®šä¹‰æ ‡ç­¾**ï¼ˆæ‰‹åŠ¨æ‰“æ ‡ç­¾ï¼‰ï¼š
- é‡ç‚¹å®¢æˆ·
- åˆä½œä¼™ä¼´
- æµ‹è¯•å®¢æˆ·
- é—®é¢˜å®¢æˆ·
- å…¶ä»–è‡ªå®šä¹‰

##### æ ‡ç­¾æ“ä½œ
- æ·»åŠ æ ‡ç­¾
- ç§»é™¤æ ‡ç­¾
- æ‰¹é‡æ‰“æ ‡ç­¾
- æ ‡ç­¾ç­›é€‰

#### æ•°æ®ç»“æ„

```typescript
// å®¢æˆ·
interface Customer {
  id: string
  nickname: string
  phone: string
  avatar: string
  
  // å®åè®¤è¯
  is_verified: boolean
  real_name: string
  id_card_masked: string
  
  // çŠ¶æ€ä¿¡æ¯
  status: 'active' | 'frozen'
  vip_level: number
  register_time: string
  last_login: string
  
  // ä¸šåŠ¡ç»Ÿè®¡
  total_orders: number
  completed_orders: number
  total_amount: number
  average_rating: number
  
  // æ ‡ç­¾
  tags: string[]
  
  // å…³è”å…¬å¸
  companies: {
    company_id: string
    company_name: string
    relation: 'owner' | 'employee'
  }[]
}

// å®¢æˆ·å…³è”å…¬å¸
interface CustomerCompany {
  id: string
  company_name: string
  credit_code: string
  company_scale: string        // å…¬å¸è§„æ¨¡
  industry: string             // æ‰€å±è¡Œä¸š
  address: string
  business_contact: string     // ä¸šåŠ¡è”ç³»äºº
  contact_phone: string
  
  // å®¢æˆ·åˆ—è¡¨
  customers: {
    customer_id: string
    customer_name: string
    relation: 'owner' | 'employee'
    join_time: string
  }[]
  
  create_time: string
  order_count: number
  total_amount: number
}
```

---

### 3.4.3 å·¥ç¨‹å¸ˆç®¡ç†

#### åŠŸèƒ½æ¦‚è¿°
ç®¡ç†å¹³å°ä¸Šçš„æ‰€æœ‰å·¥ç¨‹å¸ˆï¼ŒåŒ…æ‹¬è®¤è¯å®¡æ ¸ã€ä¿¡èª‰åˆ†ç®¡ç†ã€æŠ€èƒ½æ ‡ç­¾ç­‰ã€‚

#### å·¥ç¨‹å¸ˆè®¤è¯å®¡æ ¸

##### å®¡æ ¸æµç¨‹
```
å·¥ç¨‹å¸ˆæäº¤è®¤è¯ç”³è¯·
    â†“
å¹³å°å®¡æ ¸èµ„è´¨
    â”œâ”€ å®¡æ ¸é€šè¿‡ â†’ å¼€é€šæ¥å•æƒé™
    â””â”€ å®¡æ ¸æ‹’ç» â†’ é€šçŸ¥åŸå› 
```

##### å®¡æ ¸å†…å®¹
**åŸºæœ¬ä¿¡æ¯**ï¼š
- å§“å
- èº«ä»½è¯å·
- æ‰‹æœºå·
- ä»ä¸šå¹´é™

**èµ„è´¨è¯æ˜**ï¼š
- èº«ä»½è¯ç…§ç‰‡
- èµ„æ ¼è¯ä¹¦
- å·¥ä½œè¯æ˜
- æ¡ˆä¾‹ç…§ç‰‡

**æŠ€èƒ½ä¿¡æ¯**ï¼š
- ä¸“ä¸šé¢†åŸŸ
- æŠ€èƒ½æ ‡ç­¾
- æœåŠ¡åŒºåŸŸ
- è‡ªæˆ‘ä»‹ç»

##### å®¡æ ¸æ“ä½œ
- **é€šè¿‡**ï¼š
  - å¼€é€šæ¥å•æƒé™
  - åˆ†é…åˆå§‹ä¿¡èª‰åˆ†
  - å‘é€é€šçŸ¥

- **æ‹’ç»**ï¼š
  - è¯´æ˜æ‹’ç»åŸå› 
  - å…è®¸é‡æ–°æäº¤

#### å·¥ç¨‹å¸ˆåˆ—è¡¨

##### åˆ—è¡¨å±•ç¤º
- **åŸºæœ¬ä¿¡æ¯**ï¼š
  - å§“å
  - æ‰‹æœºå·
  - æ‰€å±ä¾›åº”å•†
  - ä»ä¸šå¹´é™

- **è®¤è¯ä¿¡æ¯**ï¼š
  - è®¤è¯çŠ¶æ€
  - è®¤è¯æ—¶é—´
  - èµ„æ ¼è¯ä¹¦

- **ä¸šåŠ¡æ•°æ®**ï¼š
  - å®Œæˆè®¢å•æ•°
  - å®¢æˆ·è¯„åˆ†
  - ä¿¡èª‰åˆ†
  - æŠ€èƒ½æ ‡ç­¾

- **çŠ¶æ€æ ‡è¯†**ï¼š
  - åœ¨çº¿/ç¦»çº¿
  - æ¥å•ä¸­/ç©ºé—²
  - å¯ç”¨/ç¦ç”¨

##### ç­›é€‰æ¡ä»¶
- æŒ‰ä¾›åº”å•†ç­›é€‰
- æŒ‰è®¤è¯çŠ¶æ€ç­›é€‰
- æŒ‰æŠ€èƒ½æ ‡ç­¾ç­›é€‰
- æŒ‰åœ°åŒºç­›é€‰
- æŒ‰ä¿¡èª‰åˆ†ç­›é€‰

##### æ“ä½œæŒ‰é’®
- æŸ¥çœ‹è¯¦æƒ…
- ç¼–è¾‘ä¿¡æ¯
- è°ƒæ•´ä¿¡èª‰åˆ†
- æ·»åŠ æŠ€èƒ½æ ‡ç­¾
- å¯ç”¨/ç¦ç”¨

#### å·¥ç¨‹å¸ˆä¿¡èª‰åˆ†ç®¡ç†

##### ä¿¡èª‰åˆ†è®¡ç®—è§„åˆ™

**åˆå§‹åˆ†æ•°**ï¼š100åˆ†

**åŠ åˆ†é¡¹**ï¼š
- å®Œæˆè®¢å•ï¼š+2åˆ†/å•
- å®¢æˆ·å¥½è¯„ï¼š+5åˆ†/æ¬¡
- é›¶æŠ•è¯‰æœˆï¼š+10åˆ†/æœˆ
- å¿«é€Ÿå“åº”ï¼š+3åˆ†/æ¬¡

**å‡åˆ†é¡¹**ï¼š
- å®¢æˆ·å·®è¯„ï¼š-10åˆ†/æ¬¡
- å®¢æˆ·æŠ•è¯‰ï¼š-20åˆ†/æ¬¡
- æ‹’ç»æ¥å•ï¼š-5åˆ†/æ¬¡
- è¶…æ—¶æœåŠ¡ï¼š-8åˆ†/æ¬¡
- è¿è§„æ“ä½œï¼š-50åˆ†/æ¬¡

**åˆ†æ•°åŒºé—´**ï¼š
- 0-59åˆ†ï¼šä¸åˆæ ¼ï¼ˆç¦æ­¢æ¥å•ï¼‰
- 60-79åˆ†ï¼šä¸€èˆ¬ï¼ˆæ¥å•å—é™ï¼‰
- 80-89åˆ†ï¼šè‰¯å¥½ï¼ˆæ­£å¸¸æ¥å•ï¼‰
- 90-100åˆ†ï¼šä¼˜ç§€ï¼ˆä¼˜å…ˆæ¨èï¼‰

##### ä¿¡èª‰åˆ†è°ƒæ•´
- **ç³»ç»Ÿè‡ªåŠ¨è°ƒæ•´**ï¼šæ ¹æ®è§„åˆ™è‡ªåŠ¨è®¡ç®—
- **äººå·¥è°ƒæ•´**ï¼š
  - ç‰¹æ®Šæƒ…å†µäººå·¥åŠ å‡åˆ†
  - å¿…é¡»å¡«å†™è°ƒæ•´åŸå› 
  - è®°å½•è°ƒæ•´å†å²

##### ä¿¡èª‰åˆ†è®°å½•
- æ‰€æœ‰åˆ†æ•°å˜åŠ¨è®°å½•
- å˜åŠ¨æ—¶é—´ã€åŸå› 
- å½“å‰åˆ†æ•°ã€å†å²åˆ†æ•°

#### å·¥ç¨‹å¸ˆæŠ€èƒ½æ ‡ç­¾

##### æŠ€èƒ½åˆ†ç±»
**ä¸“ä¸šé¢†åŸŸ**ï¼š
- å¼±ç”µç³»ç»Ÿ
- ç½‘ç»œå·¥ç¨‹
- å®‰é˜²ç›‘æ§
- æ™ºèƒ½åŒ–ç³»ç»Ÿ
- æ¶ˆé˜²ç³»ç»Ÿ
- é€šä¿¡å·¥ç¨‹

**å…·ä½“æŠ€èƒ½**ï¼š
- å……ç”µæ¡©å®‰è£…
- æ™ºæ…§äº¤ç®¡
- æ™ºæ…§å›­åŒº
- æ™ºæ…§ä½“è‚²
- æ™ºæ…§è­¦åŠ¡
- åº”æ€¥æ¶ˆé˜²
- å‡ºå…¥å£é€šé“
- AGVæœºå™¨äºº
- å¤§æ¥¼å¼±ç”µ

**æŠ€èƒ½ç­‰çº§**ï¼š
- åˆçº§ï¼šå¯ç‹¬ç«‹å®Œæˆç®€å•ä»»åŠ¡
- ä¸­çº§ï¼šå¯ç‹¬ç«‹å®Œæˆå¸¸è§„ä»»åŠ¡
- é«˜çº§ï¼šå¯ç‹¬ç«‹å®Œæˆå¤æ‚ä»»åŠ¡
- ä¸“å®¶ï¼šå¯å¤„ç†ç–‘éš¾é—®é¢˜

##### æ ‡ç­¾ç®¡ç†
- æ·»åŠ æŠ€èƒ½æ ‡ç­¾
- è®¾ç½®æŠ€èƒ½ç­‰çº§
- ç§»é™¤æŠ€èƒ½æ ‡ç­¾
- æŠ€èƒ½è®¤è¯

#### æ•°æ®ç»“æ„

```typescript
// å·¥ç¨‹å¸ˆ
interface Engineer {
  id: string
  vendor_id: string
  name: string
  phone: string
  id_card: string
  
  // è®¤è¯ä¿¡æ¯
  is_certified: boolean
  certificates: string[]       // èµ„æ ¼è¯ä¹¦
  work_proof: string          // å·¥ä½œè¯æ˜
  case_photos: string[]       // æ¡ˆä¾‹ç…§ç‰‡
  work_years: number          // ä»ä¸šå¹´é™
  
  // æŠ€èƒ½ä¿¡æ¯
  skills: {
    domain: string            // ä¸“ä¸šé¢†åŸŸ
    skill_name: string        // æŠ€èƒ½åç§°
    skill_level: 'junior' | 'intermediate' | 'senior' | 'expert'
  }[]
  service_areas: string[]     // æœåŠ¡åŒºåŸŸ
  
  // çŠ¶æ€ä¿¡æ¯
  status: 'active' | 'disabled'
  online_status: 'online' | 'offline'
  work_status: 'busy' | 'idle'
  
  // ä¿¡èª‰åˆ†
  credit_score: number
  
  // ä¸šåŠ¡ç»Ÿè®¡
  total_orders: number
  completed_orders: number
  customer_rating: number
  complaint_count: number
  
  create_time: string
  last_login: string
}

// ä¿¡èª‰åˆ†è®°å½•
interface CreditRecord {
  id: string
  engineer_id: string
  change_type: 'add' | 'deduct'
  change_score: number
  reason: string
  related_order_id?: string
  before_score: number
  after_score: number
  operator: string             // ç³»ç»Ÿè‡ªåŠ¨ or ç®¡ç†å‘˜ID
  create_time: string
}
```

---

## ğŸ”Œ åç«¯APIæ¥å£

### æ´¾å•ç®¡ç†

```typescript
// åˆ›å»ºæ´¾å•
POST /api/admin/assignments/create
Request: {
  order_id: string
  engineers: {
    engineer_id: string
    role: string
    work_content: string
    work_ratio: number
  }[]
}

// è°ƒæ•´æ´¾å•
PUT /api/admin/assignments/:id
Request: {
  engineers: [...]
}

// æ´¾å•åˆ—è¡¨
GET /api/admin/assignments
Query: { status, engineer_id, date_range }
```

### è®¢å•å®¡æ ¸

```typescript
// å¾…å®¡æ ¸åˆ—è¡¨
GET /api/admin/reviews/pending
Query: { type: 'vendor' | 'platform', page, size }

// å®¡æ ¸æ“ä½œ
POST /api/admin/reviews/:id/approve
POST /api/admin/reviews/:id/reject
Request: {
  comment: string
  reject_reason?: string
}
```

### èŠå¤©åŠŸèƒ½

```typescript
// WebSocketè¿æ¥
WS wss://api.example.com/chat?token=xxx

// è·å–èŠå¤©å®¤åˆ—è¡¨
GET /api/chat/rooms
Query: { user_id }

// è·å–æ¶ˆæ¯å†å²
GET /api/chat/messages
Query: { room_id, page, size }

// å‘é€æ¶ˆæ¯
POST /api/chat/messages
Request: {
  room_id: string
  message_type: string
  content: string
}
```

### ä¾›åº”å•†ç®¡ç†

```typescript
// ä¾›åº”å•†åˆ—è¡¨
GET /api/admin/vendors
Query: { status, domain, area, page, size }

// ä¾›åº”å•†è¯¦æƒ…
GET /api/admin/vendors/:id

// å®¡æ ¸ä¾›åº”å•†
POST /api/admin/vendors/:id/approve
POST /api/admin/vendors/:id/reject

// å¯ç”¨/ç¦ç”¨
PUT /api/admin/vendors/:id/status
Request: { status: 'active' | 'disabled', reason }
```

### å®¢æˆ·ç®¡ç†

```typescript
// å®¢æˆ·åˆ—è¡¨
GET /api/admin/customers
Query: { status, vip_level, tags, page, size }

// å®¢æˆ·è¯¦æƒ…
GET /api/admin/customers/:id

// å®¢æˆ·å…¬å¸åˆ—è¡¨
GET /api/admin/customers/:id/companies

// æ·»åŠ æ ‡ç­¾
POST /api/admin/customers/:id/tags
Request: { tags: string[] }
```

### å·¥ç¨‹å¸ˆç®¡ç†

```typescript
// å·¥ç¨‹å¸ˆåˆ—è¡¨
GET /api/admin/engineers
Query: { vendor_id, status, skills, area, page, size }

// å·¥ç¨‹å¸ˆè¯¦æƒ…
GET /api/admin/engineers/:id

// å®¡æ ¸å·¥ç¨‹å¸ˆ
POST /api/admin/engineers/:id/approve
POST /api/admin/engineers/:id/reject

// è°ƒæ•´ä¿¡èª‰åˆ†
POST /api/admin/engineers/:id/credit
Request: {
  change_type: 'add' | 'deduct'
  change_score: number
  reason: string
}
```

---

## ğŸ“Š æ•°æ®åº“è¡¨è®¾è®¡

### assignmentsï¼ˆæ´¾å•è¡¨ï¼‰
```sql
CREATE TABLE assignments (
  id VARCHAR(32) PRIMARY KEY,
  order_id VARCHAR(32),
  assign_time DATETIME,
  assign_by VARCHAR(32),
  status VARCHAR(20),
  INDEX idx_order (order_id)
);
```

### assignment_engineersï¼ˆæ´¾å•å·¥ç¨‹å¸ˆå…³è”è¡¨ï¼‰
```sql
CREATE TABLE assignment_engineers (
  id VARCHAR(32) PRIMARY KEY,
  assignment_id VARCHAR(32),
  engineer_id VARCHAR(32),
  role VARCHAR(20),
  work_content TEXT,
  work_ratio INT,
  accept_status VARCHAR(20),
  accept_time DATETIME,
  reject_reason TEXT,
  INDEX idx_assignment (assignment_id),
  INDEX idx_engineer (engineer_id)
);
```

### completion_requestsï¼ˆå®Œæˆç”³è¯·è¡¨ï¼‰
```sql
CREATE TABLE completion_requests (
  id VARCHAR(32) PRIMARY KEY,
  order_id VARCHAR(32),
  engineer_id VARCHAR(32),
  submit_time DATETIME,
  completion_photos TEXT,
  completion_report TEXT,
  customer_signature VARCHAR(255),
  vendor_review_status VARCHAR(20),
  platform_review_status VARCHAR(20),
  INDEX idx_order (order_id)
);
```

### chat_roomsï¼ˆèŠå¤©å®¤è¡¨ï¼‰
```sql
CREATE TABLE chat_rooms (
  id VARCHAR(32) PRIMARY KEY,
  order_id VARCHAR(32),
  order_no VARCHAR(50),
  service_type VARCHAR(50),
  create_time DATETIME,
  last_message_time DATETIME,
  INDEX idx_order (order_id)
);
```

### chat_messagesï¼ˆèŠå¤©æ¶ˆæ¯è¡¨ï¼‰
```sql
CREATE TABLE chat_messages (
  id VARCHAR(32) PRIMARY KEY,
  room_id VARCHAR(32),
  sender_id VARCHAR(32),
  sender_name VARCHAR(50),
  sender_type VARCHAR(20),
  message_type VARCHAR(20),
  content TEXT,
  send_time DATETIME,
  INDEX idx_room (room_id),
  INDEX idx_sender (sender_id),
  INDEX idx_time (send_time)
);
```

### vendorsï¼ˆä¾›åº”å•†è¡¨ï¼‰
```sql
CREATE TABLE vendors (
  id VARCHAR(32) PRIMARY KEY,
  company_name VARCHAR(100),
  credit_code VARCHAR(50),
  legal_person VARCHAR(50),
  contact_person VARCHAR(50),
  contact_phone VARCHAR(20),
  status VARCHAR(20),
  credit_score INT DEFAULT 100,
  join_time DATETIME,
  INDEX idx_status (status)
);
```

### customersï¼ˆå®¢æˆ·è¡¨ï¼‰
```sql
CREATE TABLE customers (
  id VARCHAR(32) PRIMARY KEY,
  nickname VARCHAR(50),
  phone VARCHAR(20),
  is_verified BOOLEAN,
  real_name VARCHAR(50),
  vip_level INT DEFAULT 0,
  status VARCHAR(20),
  register_time DATETIME,
  INDEX idx_phone (phone),
  INDEX idx_vip (vip_level)
);
```

### customer_companiesï¼ˆå®¢æˆ·å…³è”å…¬å¸è¡¨ï¼‰
```sql
CREATE TABLE customer_companies (
  id VARCHAR(32) PRIMARY KEY,
  customer_id VARCHAR(32),
  company_id VARCHAR(32),
  relation VARCHAR(20),
  join_time DATETIME,
  INDEX idx_customer (customer_id),
  INDEX idx_company (company_id)
);
```

### engineersï¼ˆå·¥ç¨‹å¸ˆè¡¨ï¼‰
```sql
CREATE TABLE engineers (
  id VARCHAR(32) PRIMARY KEY,
  vendor_id VARCHAR(32),
  name VARCHAR(50),
  phone VARCHAR(20),
  is_certified BOOLEAN DEFAULT FALSE,
  status VARCHAR(20),
  credit_score INT DEFAULT 100,
  create_time DATETIME,
  INDEX idx_vendor (vendor_id),
  INDEX idx_status (status),
  INDEX idx_credit (credit_score)
);
```

### credit_recordsï¼ˆä¿¡èª‰åˆ†è®°å½•è¡¨ï¼‰
```sql
CREATE TABLE credit_records (
  id VARCHAR(32) PRIMARY KEY,
  engineer_id VARCHAR(32),
  change_type VARCHAR(20),
  change_score INT,
  reason TEXT,
  before_score INT,
  after_score INT,
  operator VARCHAR(32),
  create_time DATETIME,
  INDEX idx_engineer (engineer_id),
  INDEX idx_time (create_time)
);
```

---

## ğŸ’» å‰ç«¯æŠ€æœ¯æ–¹æ¡ˆ

### ç®¡ç†åå°æŠ€æœ¯æ ˆï¼ˆæ¨èï¼‰

**æ¡†æ¶**ï¼šVue 3 + TypeScript
**UIç»„ä»¶åº“**ï¼šElement Plus / Ant Design Vue
**çŠ¶æ€ç®¡ç†**ï¼šPinia
**è·¯ç”±**ï¼šVue Router
**HTTPè¯·æ±‚**ï¼šAxios
**WebSocket**ï¼šSocket.io-client
**å›¾è¡¨**ï¼šECharts
**å¯Œæ–‡æœ¬**ï¼šTinyMCE / Quill

### é¡µé¢ç»“æ„

```
/admin
  /dashboard           # ä»ªè¡¨æ¿
  /orders              # è®¢å•ç®¡ç†
    /list              # è®¢å•åˆ—è¡¨
    /detail/:id        # è®¢å•è¯¦æƒ…
    /assign            # æ´¾å•
    /review            # å®¡æ ¸
  /chat                # èŠå¤©
    /rooms             # èŠå¤©å®¤åˆ—è¡¨
    /room/:id          # èŠå¤©ç•Œé¢
  /vendors             # ä¾›åº”å•†ç®¡ç†
    /list              # ä¾›åº”å•†åˆ—è¡¨
    /detail/:id        # ä¾›åº”å•†è¯¦æƒ…
    /review            # å®¡æ ¸
  /customers           # å®¢æˆ·ç®¡ç†
    /list              # å®¢æˆ·åˆ—è¡¨
    /detail/:id        # å®¢æˆ·è¯¦æƒ…
  /engineers           # å·¥ç¨‹å¸ˆç®¡ç†
    /list              # å·¥ç¨‹å¸ˆåˆ—è¡¨
    /detail/:id        # å·¥ç¨‹å¸ˆè¯¦æƒ…
    /review            # è®¤è¯å®¡æ ¸
```

---

## ğŸ“ æ€»ç»“

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†ï¼š

1. **æœåŠ¡å•†ç®¡ç†ç«¯**ï¼š
   - æ´¾å•ç®¡ç†ï¼ˆå¤šäººåä½œã€æ¥å•ç¡®è®¤ã€æ´¾å•è°ƒæ•´ï¼‰
   - è®¢å•å®¡æ ¸ï¼ˆæœåŠ¡å•†å®¡æ ¸ã€æäº¤å¹³å°å®¡æ ¸ï¼‰
   - èŠå¤©åŠŸèƒ½ï¼ˆç¾¤èŠæ¨¡å¼ã€æ–‡å­—å›¾ç‰‡ï¼‰

2. **å¹³å°ç®¡ç†ç«¯**ï¼š
   - ä¾›åº”å•†ç®¡ç†ï¼ˆå®¡æ ¸ã€åˆ—è¡¨ã€ç®¡ç†å‘˜ã€çŠ¶æ€ï¼‰
   - å®¢æˆ·ç®¡ç†ï¼ˆåˆ—è¡¨ã€å…¬å¸ä¿¡æ¯ã€è®¢å•ç»Ÿè®¡ã€æ ‡ç­¾ï¼‰
   - å·¥ç¨‹å¸ˆç®¡ç†ï¼ˆè®¤è¯å®¡æ ¸ã€åˆ—è¡¨ã€ä¿¡èª‰åˆ†ã€æŠ€èƒ½æ ‡ç­¾ï¼‰

3. **æŠ€æœ¯å®ç°**ï¼š
   - åç«¯APIæ¥å£è®¾è®¡
   - æ•°æ®åº“è¡¨è®¾è®¡
   - å‰ç«¯æŠ€æœ¯æ–¹æ¡ˆ

**æ³¨æ„**ï¼šä»¥ä¸Šä¸ºéœ€æ±‚æ–‡æ¡£å’ŒæŠ€æœ¯æ–¹æ¡ˆï¼Œå®é™…å¼€å‘éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´ã€‚

